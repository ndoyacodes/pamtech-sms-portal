import{j as e,B as o,c as v,k as H,r as g,l as B,y as P}from"./index-d9TgJTTy.js";import{D as S,f as U,b,c as G,d as I,g as $,a as E,e as h,u as O,L as N}from"./use-auth-store-CiawQdvf.js";import{u as Q,S as _,T as J,U as W}from"./user-nav-1-09pvFT.js";import{u as X,g as Y,a as Z,b as ee,c as se,d as ae,e as te,T as le,f as ne,h as C,i as ie,j as R,k as re,l as F}from"./table-DaUOpY8m.js";import{D as oe,C as ce,d as de,e as me,M as xe,P as ge,n as he,F as ue,f as pe,A as k,g as M,h as je,E as fe,i as we}from"./index-CD610jSn.js";import{S as ve,a as Ne,b as Ce,c as ye,d as Se}from"./select-cMMktxW9.js";import{I as be}from"./input-DpwfBUf3.js";import{B as w}from"./badge-DjWKEn-0.js";import{P as Ie,a as Te,b as De,C as Pe,c as Re,d as Fe,e as ke,f as V,g as z,h as Me}from"./popover-CnlP89lX.js";import{S as Ve}from"./separator-BUjyEJiy.js";import{I as ze}from"./IconPlus-DdfCuiNF.js";import{C as A}from"./checkbox-BGteumho.js";import{z as x}from"./index-C3hmKdn7.js";import{D as Ae,a as He,b as Ee,c as qe,d as Ke}from"./dialog-BlA-gPk4.js";import{u as Le}from"./useMutation-scFYzLXQ.js";import{t as y}from"./template.service-BIwPJcYg.js";import"./index-Chc_HW3c.js";import"./index-EIcx_2LO.js";import"./Combination-D2mTRfsA.js";import"./index-LU4gLCaG.js";import"./index-DT5heVsp.js";import"./index-BIPiAFp5.js";import"./instance-BGpPafi2.js";import"./index-W6PM2pC6.js";import"./index-BCvMni3w.js";import"./extends-CF3RwP-h.js";function Be({table:s}){var a,t,i,n;return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[(t=(a=s.getFilteredSelectedRowModel())==null?void 0:a.rows)==null?void 0:t.length," of"," ",(n=(i=s.getFilteredRowModel())==null?void 0:i.rows)==null?void 0:n.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(ve,{value:`${s.getState().pagination.pageSize}`,onValueChange:l=>{s.setPageSize(Number(l))},children:[e.jsx(Ne,{className:"h-8 w-[70px]",children:e.jsx(Ce,{placeholder:s.getState().pagination.pageSize})}),e.jsx(ye,{side:"top",children:[10,20,30,40,50].map(l=>e.jsx(Se,{value:`${l}`,children:l},l))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(o,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(oe,{className:"h-4 w-4"})]}),e.jsxs(o,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(ce,{className:"h-4 w-4"})]}),e.jsxs(o,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(de,{className:"h-4 w-4"})]}),e.jsxs(o,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(me,{className:"h-4 w-4"})]})]})]})]})}function Ue({table:s}){return e.jsxs(S,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(b,{align:"end",className:"w-[150px]",children:[e.jsx(G,{children:"Toggle columns"}),e.jsx(I,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx($,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:t=>a.toggleVisibility(!!t),children:a.id},a.id))]})]})}function Ge({column:s,title:a,options:t}){const i=s==null?void 0:s.getFacetedUniqueValues(),n=new Set(s==null?void 0:s.getFilterValue());return e.jsxs(Ie,{children:[e.jsx(Te,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),a,(n==null?void 0:n.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ve,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(w,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:n.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:n.size>2?e.jsxs(w,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[n.size," selected"]}):t.filter(l=>n.has(l.value)).map(l=>e.jsx(w,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:l.label},l.value))})]})]})}),e.jsx(De,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Pe,{children:[e.jsx(Re,{placeholder:a}),e.jsxs(Fe,{children:[e.jsx(ke,{children:"No results found."}),e.jsx(V,{children:t.map(l=>{const r=n.has(l.value);return e.jsxs(z,{onSelect:()=>{r?n.delete(l.value):n.add(l.value);const m=Array.from(n);s==null||s.setFilterValue(m.length?m:void 0)},children:[e.jsx("div",{className:v("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",r?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(he,{className:v("h-4 w-4")})}),l.icon&&e.jsx(l.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:l.label}),(i==null?void 0:i.get(l.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(l.value)})]},l.value)})}),n.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsx(V,{children:e.jsx(z,{onSelect:()=>s==null?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function $e({table:s}){var i;const a=s.getState().columnFilters.length>0,t=H();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(be,{placeholder:"Filter Regions...",value:((i=s.getColumn("name"))==null?void 0:i.getFilterValue())??"",onChange:n=>{var l;return(l=s.getColumn("name"))==null?void 0:l.setFilterValue(n.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[s.getColumn("status")&&e.jsx(Ge,{column:s.getColumn("status"),title:"Status",options:[{label:"Active",value:"Active"},{label:"Inactive",value:"Inactive"}]}),e.jsxs(o,{variant:"default",onClick:()=>t("/templates/add"),className:"h-8 px-2 lg:px-3",children:["Create New Template",e.jsx(ze,{className:"ml-2 h-4 w-4"})]}),e.jsxs(o,{variant:"default",className:"h-8 px-2 lg:px-3",children:["Export",e.jsx(ue,{className:"ml-2 h-4 w-4"})]})]}),a&&e.jsxs(o,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(pe,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Ue,{table:s})]})}function Oe({columns:s,data:a,pagination:t,onPaginationChange:i,totalElements:n}){var T,D;const[l,r]=g.useState({}),[m,j]=g.useState({}),[f,q]=g.useState([]),[K,L]=g.useState([]),u=X({data:a,columns:s,state:{sorting:K,columnVisibility:m,rowSelection:l,columnFilters:f,pagination:t},manualPagination:!0,pageCount:Math.ceil(n/(t==null?void 0:t.pageSize)),onPaginationChange:d=>{const c=typeof d=="function"?d(t):d;i(c)},enableRowSelection:!0,onRowSelectionChange:r,onSortingChange:L,onColumnFiltersChange:q,onColumnVisibilityChange:j,getCoreRowModel:Y(),getFilteredRowModel:Z(),getPaginationRowModel:ee(),getSortedRowModel:se(),getFacetedRowModel:ae(),getFacetedUniqueValues:te()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx($e,{table:u}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(le,{children:[e.jsx(ne,{children:u.getHeaderGroups().map(d=>e.jsx(C,{children:d.headers.map(c=>e.jsx(ie,{colSpan:c.colSpan,children:c.isPlaceholder?null:R(c.column.columnDef.header,c.getContext())},c.id))},d.id))}),e.jsx(re,{children:(T=u.getRowModel().rows)!=null&&T.length?(D=u.getRowModel().rows)==null?void 0:D.map(d=>e.jsx(C,{"data-state":d.getIsSelected()&&"selected",children:d.getVisibleCells().map(c=>e.jsx(F,{children:R(c.column.columnDef.cell,c.getContext())},c.id))},d.id)):e.jsx(C,{children:e.jsx(F,{colSpan:s==null?void 0:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Be,{table:u})]})}function p({column:s,title:a,className:t}){return s.getCanSort()?e.jsx("div",{className:v("flex items-center space-x-2",t),children:e.jsxs(S,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(o,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:a}),s.getIsSorted()==="desc"?e.jsx(k,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(M,{className:"ml-2 h-4 w-4"}):e.jsx(je,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(b,{align:"start",children:[e.jsxs(h,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(M,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(h,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(k,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(I,{}),e.jsxs(h,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(fe,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:v(t),children:a})}const Qe=x.object({message:x.string(),messageType:x.enum(["dynamic","static"]),name:x.string(),id:x.number(),createdAt:x.string(),updatedAt:x.string(),active:x.boolean()}),_e=({id:s,name:a,onClose:t})=>{const i=B(),n=Le({mutationFn:async()=>await y.deleteTemplate(s),onSuccess:()=>{P.success("Template deleted successfully"),i.invalidateQueries({queryKey:["templates"]}),t()},onError:r=>{var j,f;const m=((f=(j=r==null?void 0:r.response)==null?void 0:j.data)==null?void 0:f.message)||"Failed to delete template";P.error(m)}}),l=()=>{n.mutate()};return e.jsx(Ae,{open:!0,onOpenChange:t,children:e.jsxs(He,{children:[e.jsxs(Ee,{children:[e.jsx(qe,{children:"Delete Template"}),e.jsxs(Ke,{children:["Are you sure you want to delete ",e.jsx("strong",{children:a}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(o,{variant:"secondary",onClick:t,children:"Cancel"}),e.jsx(o,{variant:"destructive",loading:n.isPending,onClick:l,disabled:n.isPending,children:"Delete"})]})]})})};function Je({row:s}){const a=Qe.parse(s.original),[t,i]=g.useState(!1),n=H();return e.jsxs(S,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(o,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(b,{align:"end",className:"w-[160px]",children:[e.jsx(h,{onClick:()=>{n(`/templates/${a.id}`,{state:{record:a}})},children:"View"}),e.jsx(h,{onClick:()=>{n("/templates/add/",{state:{record:a}})},children:"Edit"}),e.jsx(I,{}),e.jsx(h,{onClick:()=>{i(!0)},children:"Delete"})]}),t&&e.jsx(_e,{id:a.id,name:a.name,onClose:()=>i(!1)})]})}const We=[{id:"select",header:({table:s})=>e.jsx(A,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(A,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(p,{column:s,title:"#"}),cell:({row:s})=>e.jsx("div",{className:"w-[80px]",children:s.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:s})=>e.jsx(p,{column:s,title:"Name"}),cell:({row:s})=>e.jsx("div",{className:"w-[120px]",children:s.getValue("name")}),enableSorting:!0,enableHiding:!1},{accessorKey:"messageType",header:({column:s})=>e.jsx(p,{column:s,title:"Message type"}),cell:({row:s})=>e.jsx("div",{className:"w-[150px]",children:s.getValue("messageType")}),enableSorting:!0,enableHiding:!1},{accessorKey:"message",header:({column:s})=>e.jsx(p,{column:s,title:"Message"}),cell:({row:s})=>{const a=s.getValue("message");return e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:typeof a=="string"&&a.length>50?`${a.slice(0,50)}...`:a})})},enableSorting:!0,enableHiding:!1},{accessorKey:"activated",header:({column:s})=>e.jsx(p,{column:s,title:"Status"}),cell:({row:s})=>{console.log(s);const a=s.original.active;return e.jsx("div",{className:"flex w-[100px] items-center",children:e.jsx(w,{variant:a?"default":"destructive",children:a?"Active":"Inactive"})})}},{id:"actions",cell:({row:s})=>e.jsx(Je,{row:s})}];function ys(){const[s,a]=g.useState({pageIndex:0,pageSize:10}),{user:t}=O(),{data:i,isLoading:n}=Q({queryKey:["templates",s.pageIndex,s.pageSize],queryFn:async()=>{var l;if(t!=null&&t.customer){const r=await y.getCustomerTemplates((l=t==null?void 0:t.customer)==null?void 0:l.id,{page:s.pageIndex,size:s.pageSize});return{content:r||[],totalElements:r==null?void 0:r.totalElements}}else{const r=await y.getTemplates({page:s.pageIndex,size:s.pageSize});return{content:r||[],totalElements:r==null?void 0:r.totalElements}}},retry:2,staleTime:5*60*1e3});return console.log(i),e.jsxs(N,{children:[e.jsxs(N.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(_,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(J,{}),e.jsx(W,{})]})]}),e.jsxs(N.Body,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Templates"}),e.jsx("p",{className:"text-muted-foreground",children:"Here's a list of your templates"})]})}),n?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(Oe,{data:i==null?void 0:i.content,columns:We,pagination:s,onPaginationChange:a,totalElements:(i==null?void 0:i.totalElements)||0})})]})]})}export{ys as default};
