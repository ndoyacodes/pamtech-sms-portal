import{j as e,B as r,k as E,r as x,c as D,l as O,y as I}from"./index-d9TgJTTy.js";import{D as w,f as K,b as S,c as L,d as V,g as G,a as F,e as o,L as C}from"./use-auth-store-CiawQdvf.js";import{u as q,S as $,T as U,U as J}from"./user-nav-1-09pvFT.js";import{u as Q,g as W,a as X,b as Y,c as Z,d as _,e as ee,T as se,f as ae,h as N,i as te,j as b,k as le,l as R}from"./table-DaUOpY8m.js";import{D as ne,C as re,d as ie,e as oe,M as ce,F as de,f as me,A as k,g as P,h as xe,E as ue,i as pe}from"./index-CD610jSn.js";import{S as ge,a as he,b as je,c as fe,d as ve}from"./select-cMMktxW9.js";import{I as Ce}from"./input-DpwfBUf3.js";import{I as Ne}from"./IconPlus-DdfCuiNF.js";import{B as A}from"./badge-DjWKEn-0.js";import{C as M}from"./checkbox-BGteumho.js";import{z as n}from"./index-C3hmKdn7.js";import{C as T}from"./cusstomer-approval-modal-CrQzLY4o.js";import{D as we,a as Se,b as ye,c as De,d as Ie}from"./dialog-BlA-gPk4.js";import{u as be}from"./useMutation-scFYzLXQ.js";import{c as z}from"./customer-hook-91Ge935x.js";import"./index-Chc_HW3c.js";import"./index-EIcx_2LO.js";import"./Combination-D2mTRfsA.js";import"./index-LU4gLCaG.js";import"./index-DT5heVsp.js";import"./index-BIPiAFp5.js";import"./instance-BGpPafi2.js";import"./index-W6PM2pC6.js";import"./index-BCvMni3w.js";import"./label-BkzUlrRU.js";import"./textarea-DzV--754.js";function Re({table:s}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(ge,{value:`${s.getState().pagination.pageSize}`,onValueChange:a=>{s.setPageSize(Number(a))},children:[e.jsx(he,{className:"h-8 w-[70px]",children:e.jsx(je,{placeholder:s.getState().pagination.pageSize})}),e.jsx(fe,{side:"top",children:[10,20,30,40,50].map(a=>e.jsx(ve,{value:`${a}`,children:a},a))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(r,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(ne,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(re,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(ie,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(oe,{className:"h-4 w-4"})]})]})]})]})}function ke({table:s}){return e.jsxs(w,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(S,{align:"end",className:"w-[150px]",children:[e.jsx(L,{children:"Toggle columns"}),e.jsx(V,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx(G,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:t=>a.toggleVisibility(!!t),children:a.id},a.id))]})]})}function Pe({table:s}){var l;const a=s.getState().columnFilters.length>0,t=E();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(Ce,{placeholder:"Filter customers...",value:((l=s.getColumn("title"))==null?void 0:l.getFilterValue())??"",onChange:c=>{var m;return(m=s.getColumn("title"))==null?void 0:m.setFilterValue(c.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsxs(r,{variant:"default",onClick:()=>t("/customers/add"),className:"h-8 px-2 lg:px-3",children:["Add customer",e.jsx(Ne,{className:"ml-2 h-4 w-4"})]}),e.jsxs(r,{variant:"default",className:"h-8 px-2 lg:px-3",children:["Export",e.jsx(de,{className:"ml-2 h-4 w-4"})]})]}),a&&e.jsxs(r,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(me,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(ke,{table:s})]})}function Ae({columns:s,data:a,pagination:t,onPaginationChange:l,totalElements:c}){var y;const[m,u]=x.useState({}),[p,g]=x.useState({}),[h,v]=x.useState([]),[H,B]=x.useState([]),f=Q({data:a,columns:s,state:{sorting:H,columnVisibility:p,rowSelection:m,columnFilters:h,pagination:t},manualPagination:!0,pageCount:Math.ceil(c/t.pageSize),onPaginationChange:d=>{const i=typeof d=="function"?d(t):d;l(i)},enableRowSelection:!0,onRowSelectionChange:u,onSortingChange:B,onColumnFiltersChange:v,onColumnVisibilityChange:g,getCoreRowModel:W(),getFilteredRowModel:X(),getPaginationRowModel:Y(),getSortedRowModel:Z(),getFacetedRowModel:_(),getFacetedUniqueValues:ee()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Pe,{table:f}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(se,{children:[e.jsx(ae,{children:f.getHeaderGroups().map(d=>e.jsx(N,{children:d.headers.map(i=>e.jsx(te,{colSpan:i.colSpan,children:i.isPlaceholder?null:b(i.column.columnDef.header,i.getContext())},i.id))},d.id))}),e.jsx(le,{children:(y=f.getRowModel().rows)!=null&&y.length?f.getRowModel().rows.map(d=>e.jsx(N,{"data-state":d.getIsSelected()&&"selected",children:d.getVisibleCells().map(i=>e.jsx(R,{children:b(i.column.columnDef.cell,i.getContext())},i.id))},d.id)):e.jsx(N,{children:e.jsx(R,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Re,{table:f})]})}function j({column:s,title:a,className:t}){return s.getCanSort()?e.jsx("div",{className:D("flex items-center space-x-2",t),children:e.jsxs(w,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(r,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:a}),s.getIsSorted()==="desc"?e.jsx(k,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(P,{className:"ml-2 h-4 w-4"}):e.jsx(xe,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(S,{align:"start",children:[e.jsxs(o,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(P,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(o,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(k,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(V,{}),e.jsxs(o,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(ue,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:D(t),children:a})}const Me=n.object({id:n.number(),email:n.string().email(),firstName:n.string(),lastName:n.string(),timezone:n.string(),status:n.boolean(),language:n.string(),companyName:n.string(),website:n.any(),customerType:n.any(),approvalStatus:n.string()}),Te=({mode:s,onClose:a,customerId:t})=>{const l=O(),c=be({mutationFn:async()=>await z.approveCustomer({id:t,remarks:"",approved:!1}),onSuccess:()=>{I.success("Customer approval revoked successfully"),l.invalidateQueries({queryKey:["customers"]}),a()},onError:u=>{var g,h;const p=((h=(g=u==null?void 0:u.response)==null?void 0:g.data)==null?void 0:h.message)||"Failed to revoke approval";I.error(p)}}),m=()=>{if(s="approve")return a(),!0;c.mutate()};return e.jsx(we,{open:!0,onOpenChange:a,children:e.jsxs(Se,{children:[e.jsxs(ye,{children:[e.jsx(De,{children:"Customer Appproval"}),e.jsxs(Ie,{children:["Are you sure you want to confirm  ",e.jsx("strong",{children:s==="approve"?"Appproval":"Disapprove"}),"? This customer."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(r,{variant:"secondary",onClick:a,children:"Cancel"}),e.jsx(r,{variant:"destructive",loading:c.isPending,onClick:m,disabled:c.isPending,children:"Confirm"})]})]})})};function Ee({row:s}){const a=Me.parse(s.original),[t,l]=x.useState(!1),[c,m]=x.useState(!1),[u,p]=x.useState(!1),g=E(),h=()=>{l(!1)},v=()=>{p(!1)};return e.jsxs(w,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(r,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(S,{align:"end",className:"w-[160px]",children:[e.jsx(o,{onClick:()=>{g(`/customer/${a.id}`)},children:"View"}),a.approvalStatus!=="DISABLED"&&a.approvalStatus!=="REJECTED"&&e.jsx(o,{onClick:()=>p(!0),children:"Deactivate"}),a.approvalStatus==="DISABLED"&&e.jsx(o,{onClick:()=>l(!0),children:"Activate"}),a.approvalStatus==="REJECTED"&&e.jsx(o,{onClick:()=>l(!0),children:"Activate"}),a.approvalStatus!=="REJECTED"&&e.jsx(o,{onClick:()=>{g("/customers/add",{state:{record:a}})},children:"Edit"}),a.approvalStatus==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{onClick:()=>l(!0),children:"Approve"}),e.jsx(o,{onClick:()=>p(!0),children:"Reject"}),e.jsx(o,{children:"Delete"})]})]}),c&&e.jsx(Te,{mode:"disapprove",customerId:a==null?void 0:a.id,onClose:()=>m(!1)}),t&&e.jsx(T,{customerId:a==null?void 0:a.id,actionType:a.approvalStatus==="PENDING"?"APPROVE":"ACTIVATE",onClose:h}),u&&e.jsx(T,{customerId:a==null?void 0:a.id,actionType:a.approvalStatus==="APPROVED"?"DEACTIVATE":"REJECT",onClose:v})]})}const Ve=[{id:"select",header:({table:s})=>e.jsx(M,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(M,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(j,{column:s,title:"S/NO"}),cell:({row:s})=>e.jsx("div",{className:"w-[80px]",children:s.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:({column:s})=>e.jsx(j,{column:s,title:"Email"}),cell:({row:s})=>e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("email")})},{accessorKey:"fullName",header:({column:s})=>e.jsx(j,{column:s,title:"Name"}),cell:({row:s})=>{const a=s.original.firstName||"",t=s.original.lastName||"";return e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:`${a} ${t}`.trim()||"N/A"})}},{accessorKey:"companyName",header:({column:s})=>e.jsx(j,{column:s,title:"Company"}),cell:({row:s})=>e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("companyName")||"N/A"})},{accessorKey:"approvalStatus",header:({column:s})=>e.jsx(j,{column:s,title:"Approval"}),cell:({row:s})=>e.jsx(A,{variant:s.getValue("approvalStatus")==="PENDING"||s.getValue("approvalStatus")===null?"secondary":s.getValue("approvalStatus")==="APPROVED"?"success":"destructive",children:s.getValue("approvalStatus")})},{accessorKey:"status",header:({column:s})=>e.jsx(j,{column:s,title:"Status"}),cell:({row:s})=>e.jsx(A,{variant:s.getValue("status")===!0?"success":s.getValue("status")===!1?"secondary":"destructive",children:s.getValue("status")===!0?"Active":(s.getValue("status")===!1,"Inactive")})},{id:"actions",cell:({row:s})=>e.jsx(Ee,{row:s})}];function os(){const[s,a]=x.useState({pageIndex:0,pageSize:10}),{data:t,isLoading:l}=q({queryKey:["customers",s.pageIndex,s.pageSize],queryFn:async()=>await z.getCustomers({page:s.pageIndex,size:s.pageSize})||[],retry:2,staleTime:5*60*1e3});return e.jsxs(C,{children:[e.jsxs(C.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx($,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(U,{}),e.jsx(J,{})]})]}),e.jsxs(C.Body,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Customers"}),e.jsx("p",{className:"text-muted-foreground",children:"Here's a list of your customers"})]})}),l?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(Ae,{data:t||[],columns:Ve,pagination:s,onPaginationChange:a,totalElements:(t==null?void 0:t.totalElements)||0})})]})]})}export{os as default};
