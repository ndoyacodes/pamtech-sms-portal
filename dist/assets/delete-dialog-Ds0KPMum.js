import{j as e,B as r,c as j,k as B,r as u,l as H,y as b}from"./index-d9TgJTTy.js";import{u as E,g as q,a as G,b as L,c as Q,d as U,e as $,T as O,f as K,h as f,i as _,j as S,k as J,l as y}from"./table-DaUOpY8m.js";import{D as W,C as X,d as Y,e as Z,M as ee,Q as se,k as ae,S as ne,l as te,m as le,j as oe,A as v,P as ie,n as re,F as ce,f as de,g as P,h as me,E as xe}from"./index-CD610jSn.js";import{S as he,a as ge,b as ue,c as je,d as pe}from"./select-cMMktxW9.js";import{I as fe}from"./input-DpwfBUf3.js";import{D as M,f as Ce,b as R,c as we,d as T,g as ve,a as Ne,e as C}from"./use-auth-store-CiawQdvf.js";import{B as w}from"./badge-DjWKEn-0.js";import{P as be,a as Se,b as ye,C as Pe,c as De,d as ke,e as Ie,f as D,g as k,h as Fe}from"./popover-CnlP89lX.js";import{S as Me}from"./separator-BUjyEJiy.js";import{D as Re,a as Te,b as Ve,c as ze,d as Ae}from"./dialog-BlA-gPk4.js";import{u as Be}from"./useMutation-scFYzLXQ.js";import{c as I}from"./contacts.service-WxEaevo_.js";function He({table:s}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(he,{value:`${s.getState().pagination.pageSize}`,onValueChange:a=>{s.setPageSize(Number(a))},children:[e.jsx(ge,{className:"h-8 w-[70px]",children:e.jsx(ue,{placeholder:s.getState().pagination.pageSize})}),e.jsx(je,{side:"top",children:[10,20,30,40,50].map(a=>e.jsx(pe,{value:`${a}`,children:a},a))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(r,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(W,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(X,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(Y,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Z,{className:"h-4 w-4"})]})]})]})]})}function Ee({table:s}){return e.jsxs(M,{children:[e.jsx(Ce,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(R,{align:"end",className:"w-[150px]",children:[e.jsx(we,{children:"Toggle columns"}),e.jsx(T,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx(ve,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:l=>a.toggleVisibility(!!l),children:a.id},a.id))]})]})}const qe=[{value:"backlog",label:"Backlog",icon:se},{value:"todo",label:"Todo",icon:ae},{value:"in progress",label:"In Progress",icon:ne},{value:"done",label:"Done",icon:te},{value:"canceled",label:"Canceled",icon:le}],Ge=[{label:"Pending",value:"Pending",icon:oe},{label:"Paid",value:"Paid",icon:v}];function F({column:s,title:a,options:l}){const o=s==null?void 0:s.getFacetedUniqueValues(),t=new Set(s==null?void 0:s.getFilterValue());return e.jsxs(be,{children:[e.jsx(Se,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),a,(t==null?void 0:t.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(Me,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(w,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:t.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:t.size>2?e.jsxs(w,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[t.size," selected"]}):l.filter(n=>t.has(n.value)).map(n=>e.jsx(w,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:n.label},n.value))})]})]})}),e.jsx(ye,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Pe,{children:[e.jsx(De,{placeholder:a}),e.jsxs(ke,{children:[e.jsx(Ie,{children:"No results found."}),e.jsx(D,{children:l.map(n=>{const m=t.has(n.value);return e.jsxs(k,{onSelect:()=>{m?t.delete(n.value):t.add(n.value);const d=Array.from(t);s==null||s.setFilterValue(d.length?d:void 0)},children:[e.jsx("div",{className:j("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",m?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(re,{className:j("h-4 w-4")})}),n.icon&&e.jsx(n.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:n.label}),(o==null?void 0:o.get(n.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:o.get(n.value)})]},n.value)})}),t.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{}),e.jsx(D,{children:e.jsx(k,{onSelect:()=>s==null?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function Le({table:s}){var o;const a=s.getState().columnFilters.length>0,l=B();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(fe,{placeholder:"Filter phone...",value:((o=s.getColumn("name"))==null?void 0:o.getFilterValue())??"",onChange:t=>{var n;return(n=s.getColumn("title"))==null?void 0:n.setFilterValue(t.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[s.getColumn("status")&&e.jsx(F,{column:s.getColumn("status"),title:"Status",options:qe}),s.getColumn("priority")&&e.jsx(F,{column:s.getColumn("priority"),title:"Status",options:Ge}),e.jsxs(r,{variant:"default",onClick:()=>l("/upload-phonebook"),className:"h-8 px-2 lg:px-3",children:["Import phone book",e.jsx(ce,{className:"ml-2 h-4 w-4"})]})]}),a&&e.jsxs(r,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(de,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Ee,{table:s})]})}function ss({columns:s,data:a,pagination:l,onPaginationChange:o,totalElements:t,isIndex:n}){var N;const[m,d]=u.useState({}),[p,h]=u.useState({}),[g,V]=u.useState([]),[z,A]=u.useState([]),x=E({data:a,columns:s,state:{sorting:z,columnVisibility:p,rowSelection:m,columnFilters:g,pagination:l},manualPagination:!0,pageCount:Math.ceil(t/l.pageSize),onPaginationChange:c=>{const i=typeof c=="function"?c(l):c;o(i)},enableRowSelection:!0,onRowSelectionChange:d,onSortingChange:A,onColumnFiltersChange:V,onColumnVisibilityChange:h,getCoreRowModel:q(),getFilteredRowModel:G(),getPaginationRowModel:L(),getSortedRowModel:Q(),getFacetedRowModel:U(),getFacetedUniqueValues:$()});return e.jsxs("div",{className:"space-y-4",children:[n&&e.jsx(Le,{table:x}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(O,{children:[e.jsx(K,{children:x.getHeaderGroups().map(c=>e.jsx(f,{children:c.headers.map(i=>e.jsx(_,{colSpan:i.colSpan,children:i.isPlaceholder?null:S(i.column.columnDef.header,i.getContext())},i.id))},c.id))}),e.jsx(J,{children:(N=x.getRowModel().rows)!=null&&N.length?x.getRowModel().rows.map(c=>e.jsx(f,{"data-state":c.getIsSelected()&&"selected",children:c.getVisibleCells().map(i=>e.jsx(y,{children:S(i.column.columnDef.cell,i.getContext())},i.id))},c.id)):e.jsx(f,{children:e.jsx(y,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(He,{table:x})]})}function as({column:s,title:a,className:l}){return s.getCanSort()?e.jsx("div",{className:j("flex items-center space-x-2",l),children:e.jsxs(M,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(r,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:a}),s.getIsSorted()==="desc"?e.jsx(v,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(P,{className:"ml-2 h-4 w-4"}):e.jsx(me,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(R,{align:"start",children:[e.jsxs(C,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(P,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(C,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(v,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(T,{}),e.jsxs(C,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(xe,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:j(l),children:a})}const ns=({id:s,name:a,onClose:l,type:o})=>{const t=H(),n=Be({mutationFn:async()=>{if(o==="number")return await I.deletePhoneBookNumber(s);if(o==="phonebook")return await I.deletePhoneBook(s)},onSuccess:()=>{b.success(o==="number"?"Number deleted successfully":"Phonebook deleted successfully"),t.invalidateQueries({queryKey:["phonebook"]}),l()},onError:d=>{var h,g;const p=((g=(h=d==null?void 0:d.response)==null?void 0:h.data)==null?void 0:g.message)||"Failed to delete phonebook";b.error(p)}}),m=()=>{n.mutate()};return e.jsx(Re,{open:!0,onOpenChange:l,children:e.jsxs(Te,{children:[e.jsxs(Ve,{children:[e.jsx(ze,{children:o==="number"?"Delete Phonebook number":"Delete Phonebook"}),e.jsxs(Ae,{children:["Are you sure you want to delete this ",o==="number"?"number":"phonebook"," ",e.jsx("strong",{children:a}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(r,{variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(r,{variant:"destructive",loading:n.isPending,onClick:m,disabled:n.isPending,children:"Delete"})]})]})})};export{ns as D,as as a,ss as b};
