import{u as M,j as e,r as y,k as D,B as p}from"./index-d9TgJTTy.js";import{C as E,a as F,c as L,d as R}from"./card-CWiURnhm.js";import{L as i}from"./use-auth-store-CiawQdvf.js";import{u as P,T as C,U as b,S as B}from"./user-nav-1-09pvFT.js";import{c as S}from"./customer-hook-91Ge935x.js";import{C as g}from"./cusstomer-approval-modal-CrQzLY4o.js";import{D as T,a as I,b as H,c as U}from"./dialog-BlA-gPk4.js";import{M as V,B as O,S as q}from"./shield-CBQCwFWc.js";import{G as K}from"./globe-8DnZdi9k.js";import{L as z}from"./languages-B6rK4Ew8.js";import{c as j}from"./createLucideIcon-BDxxsDtu.js";import{C as w}from"./calendar-CpR0mcu4.js";import{f as k}from"./format-OUeO2N_p.js";import"./index-CD610jSn.js";import"./index-Chc_HW3c.js";import"./index-EIcx_2LO.js";import"./Combination-D2mTRfsA.js";import"./index-LU4gLCaG.js";import"./index-DT5heVsp.js";import"./index-BIPiAFp5.js";import"./input-DpwfBUf3.js";import"./instance-BGpPafi2.js";import"./useMutation-scFYzLXQ.js";import"./label-BkzUlrRU.js";import"./textarea-DzV--754.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=j("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=j("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=j("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=j("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]),J=({isOpen:c,onClose:d,title:n="Document Viewer"})=>{const{id:x}=M(),{data:a,isLoading:m,error:l}=P({queryKey:["customer-kycfile",x],queryFn:async()=>{try{const r=await S.getCustomerKycFile(x),s=atob(r),o=[];for(let t=0;t<s.length;t+=512){const N=s.slice(t,t+512),u=new Array(N.length);for(let h=0;h<N.length;h++)u[h]=N.charCodeAt(h);const A=new Uint8Array(u);o.push(A)}const f=new Blob(o,{type:"application/pdf"});return URL.createObjectURL(f)}catch(r){throw console.error("Error loading PDF:",r),r}}});return console.log("PDF URL:",a),e.jsx(T,{open:c,onOpenChange:d,children:e.jsxs(I,{className:"max-w-4xl h-[80vh]",children:[e.jsx(H,{children:e.jsx(U,{children:n})}),m?e.jsx("div",{className:"flex items-center justify-center h-full",children:"Loading document..."}):l?e.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"Error loading document"}),e.jsx("div",{className:"text-sm mt-1",children:l instanceof Error?l.message:"Please try again"})]})}):e.jsx("div",{className:"flex-1 w-full h-full min-h-[60vh]",children:a?e.jsx("iframe",{src:a,width:"100%",height:"100%",className:"rounded-md",title:"PDF Viewer"}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No document available"})})]})})},ue=()=>{var t;const{id:c}=M(),[d,n]=y.useState(!1),[x,a]=y.useState(!1),[m,l]=y.useState(!1),r=D(),{data:s,isLoading:o}=P({queryKey:["customer-details",c],queryFn:()=>S.getCustomerById(c)}),f=()=>{n(!1)},v=()=>{a(!1)};return o?e.jsxs(i,{children:[e.jsx(i.Header,{sticky:!0,className:"mt-4 sm:mt-4 md:mt-0 lg:mt-0",children:e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(C,{}),e.jsx(b,{})]})}),e.jsx(i.Body,{children:e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})})})]}):e.jsxs(i,{children:[e.jsxs(i.Header,{sticky:!0,className:"mt-4 sm:mt-4 md:mt-0 lg:mt-0",children:[e.jsx(B,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(C,{}),e.jsx(b,{})]})]}),e.jsxs(i.Body,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Customer Details"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage customer information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",onClick:()=>{r("/customers/add",{state:{record:s}})},children:"Edit Customer"}),(s==null?void 0:s.approvalStatus)==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"default",onClick:()=>n(!0),children:"Approve"}),e.jsx(p,{onClick:()=>a(!0),variant:"destructive",children:"Reject"})]}),(s==null?void 0:s.approvalStatus)==="PENDING"&&e.jsx(e.Fragment,{children:e.jsx(p,{variant:"destructive",onClick:()=>a(!0),children:"Revoke"})})]})]}),e.jsxs(E,{children:[e.jsx(F,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:[s==null?void 0:s.firstName," ",s==null?void 0:s.lastName]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`rounded-full px-2 py-1 text-sm ${s!=null&&s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s!=null&&s.status?"Active":"Inactive"}),e.jsx("span",{className:`rounded-full px-2 py-1 text-sm ${(s==null?void 0:s.approvalStatus)==="APPROVED"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s==null?void 0:s.approvalStatus})]})]})}),e.jsxs(L,{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"mb-4 font-semibold",children:"Personal Information"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(V,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(O,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Company Name"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.companyName})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(K,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Website"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.website})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(z,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Language"}),e.jsx("p",{className:"font-medium",children:(t=s==null?void 0:s.language)==null?void 0:t.toUpperCase()})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(W,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Timezone"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.timezone})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"mb-4 font-semibold",children:"Account Information"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(q,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Customer Type"}),e.jsx("p",{className:"font-medium",children:(s==null?void 0:s.customerType)||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx($,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"SMS Balance"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.smsBalance})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(G,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pending SMS"}),e.jsx("p",{className:"font-medium",children:s!=null&&s.hasPendingSMS?"Yes":"No"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(w,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Created At"}),e.jsx("p",{className:"font-medium",children:k(new Date(s==null?void 0:s.createdAt),"PPpp")})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(w,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Last Updated"}),e.jsx("p",{className:"font-medium",children:k(new Date(s==null?void 0:s.updatedAt),"PPpp")})]})]})]})]}),e.jsxs(R,{className:"border-t p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Y,{className:"h-5 w-5 text-gray-500"}),e.jsx("p",{className:"text-sm text-gray-500",children:"KYC Document:"}),e.jsx("div",{onClick:()=>l(!0),rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Open"})]}),(s==null?void 0:s.remarks)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Remarks:"}),e.jsx("p",{className:"mt-1",children:s==null?void 0:s.remarks})]})]})]})]}),d&&e.jsx(g,{customerId:s==null?void 0:s.id,onClose:()=>n(!1),actionType:"APPROVE"}),d&&e.jsx(g,{customerId:s==null?void 0:s.id,actionType:"APPROVE",onClose:f}),x&&e.jsx(g,{customerId:s==null?void 0:s.id,actionType:"REJECT",onClose:v}),m&&e.jsx(J,{isOpen:m,onClose:()=>l(!1),title:s==null?void 0:s.firstName})]})};export{ue as default};
