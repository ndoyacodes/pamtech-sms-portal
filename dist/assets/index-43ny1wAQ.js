import{j as e,B as r,c as w,k as A,r as h,l as q,y as D}from"./index-d9TgJTTy.js";import{D as S,f as Y,b,c as U,d as P,g as G,a as H,e as p,L as N}from"./use-auth-store-CiawQdvf.js";import{u as Q,S as O,T as $,U as W}from"./user-nav-1-09pvFT.js";import{u as _,g as J,a as X,b as Z,c as ee,d as se,e as ae,T as le,f as te,h as v,i as ne,j as k,k as ie,l as F}from"./table-DaUOpY8m.js";import{D as re,C as oe,d as ce,e as de,M as me,Q as xe,k as ge,S as he,l as ue,m as pe,j as je,A as y,P as fe,n as Ce,F as we,f as Ne,g as R,h as ve,E as ye,i as Se}from"./index-CD610jSn.js";import{S as be,a as Pe,b as Ie,c as De,d as ke}from"./select-cMMktxW9.js";import{I as Fe}from"./input-DpwfBUf3.js";import{B as j}from"./badge-DjWKEn-0.js";import{P as Re,a as Ve,b as Me,C as Te,c as ze,d as Ae,e as He,f as V,g as M,h as Ee}from"./popover-CnlP89lX.js";import{S as Le}from"./separator-BUjyEJiy.js";import{I as Ke}from"./IconPlus-DdfCuiNF.js";import{C as T}from"./checkbox-BGteumho.js";import{z as m}from"./index-C3hmKdn7.js";import{D as Be,a as qe,b as Ye,c as Ue,d as Ge}from"./dialog-BlA-gPk4.js";import{u as Qe}from"./useMutation-scFYzLXQ.js";import{p as E}from"./plan.service-DETDn82p.js";import"./index-Chc_HW3c.js";import"./index-EIcx_2LO.js";import"./Combination-D2mTRfsA.js";import"./index-LU4gLCaG.js";import"./index-DT5heVsp.js";import"./index-BIPiAFp5.js";import"./instance-BGpPafi2.js";import"./index-W6PM2pC6.js";import"./index-BCvMni3w.js";import"./extends-CF3RwP-h.js";function Oe({table:s}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(be,{value:`${s.getState().pagination.pageSize}`,onValueChange:a=>{s.setPageSize(Number(a))},children:[e.jsx(Pe,{className:"h-8 w-[70px]",children:e.jsx(Ie,{placeholder:s.getState().pagination.pageSize})}),e.jsx(De,{side:"top",children:[10,20,30,40,50].map(a=>e.jsx(ke,{value:`${a}`,children:a},a))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(r,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(re,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(oe,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(ce,{className:"h-4 w-4"})]}),e.jsxs(r,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(de,{className:"h-4 w-4"})]})]})]})]})}function $e({table:s}){return e.jsxs(S,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(b,{align:"end",className:"w-[150px]",children:[e.jsx(U,{children:"Toggle columns"}),e.jsx(P,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx(G,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:l=>a.toggleVisibility(!!l),children:a.id},a.id))]})]})}const We=[{value:"backlog",label:"Backlog",icon:xe},{value:"todo",label:"Todo",icon:ge},{value:"in progress",label:"In Progress",icon:he},{value:"done",label:"Done",icon:ue},{value:"canceled",label:"Canceled",icon:pe}],_e=[{label:"Pending",value:"Pending",icon:je},{label:"Paid",value:"Paid",icon:y}];function z({column:s,title:a,options:l}){const i=s==null?void 0:s.getFacetedUniqueValues(),t=new Set(s==null?void 0:s.getFilterValue());return e.jsxs(Re,{children:[e.jsx(Ve,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),a,(t==null?void 0:t.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(Le,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(j,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:t.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:t.size>2?e.jsxs(j,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[t.size," selected"]}):l.filter(n=>t.has(n.value)).map(n=>e.jsx(j,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:n.label},n.value))})]})]})}),e.jsx(Me,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Te,{children:[e.jsx(ze,{placeholder:a}),e.jsxs(Ae,{children:[e.jsx(He,{children:"No results found."}),e.jsx(V,{children:l.map(n=>{const d=t.has(n.value);return e.jsxs(M,{onSelect:()=>{d?t.delete(n.value):t.add(n.value);const x=Array.from(t);s==null||s.setFilterValue(x.length?x:void 0)},children:[e.jsx("div",{className:w("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",d?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Ce,{className:w("h-4 w-4")})}),n.icon&&e.jsx(n.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:n.label}),(i==null?void 0:i.get(n.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(n.value)})]},n.value)})}),t.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ee,{}),e.jsx(V,{children:e.jsx(M,{onSelect:()=>s==null?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function Je({table:s}){var i;const a=s.getState().columnFilters.length>0,l=A();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(Fe,{placeholder:"Filter ...",value:((i=s.getColumn("title"))==null?void 0:i.getFilterValue())??"",onChange:t=>{var n;return(n=s.getColumn("title"))==null?void 0:n.setFilterValue(t.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[s.getColumn("status")&&e.jsx(z,{column:s.getColumn("status"),title:"Status",options:We}),s.getColumn("priority")&&e.jsx(z,{column:s.getColumn("priority"),title:"Status",options:_e}),e.jsxs(r,{variant:"default",onClick:()=>l("/plans/add"),className:"h-8 px-2 lg:px-3",children:["Create New plan",e.jsx(Ke,{className:"ml-2 h-4 w-4"})]}),e.jsxs(r,{variant:"default",className:"h-8 px-2 lg:px-3",children:["Export",e.jsx(we,{className:"ml-2 h-4 w-4"})]})]}),a&&e.jsxs(r,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(Ne,{className:"ml-2 h-4 w-4"})]})]}),e.jsx($e,{table:s})]})}function Xe({columns:s,data:a,pagination:l,onPaginationChange:i,totalElements:t}){var I;const[n,d]=h.useState({}),[x,f]=h.useState({}),[C,L]=h.useState([]),[K,B]=h.useState([]),u=_({data:a,columns:s,state:{sorting:K,columnVisibility:x,rowSelection:n,columnFilters:C,pagination:l},manualPagination:!0,pageCount:Math.ceil(t/l.pageSize),onPaginationChange:c=>{const o=typeof c=="function"?c(l):c;i(o)},enableRowSelection:!0,onRowSelectionChange:d,onSortingChange:B,onColumnFiltersChange:L,onColumnVisibilityChange:f,getCoreRowModel:J(),getFilteredRowModel:X(),getPaginationRowModel:Z(),getSortedRowModel:ee(),getFacetedRowModel:se(),getFacetedUniqueValues:ae()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Je,{table:u}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(le,{children:[e.jsx(te,{children:u.getHeaderGroups().map(c=>e.jsx(v,{children:c.headers.map(o=>e.jsx(ne,{colSpan:o.colSpan,children:o.isPlaceholder?null:k(o.column.columnDef.header,o.getContext())},o.id))},c.id))}),e.jsx(ie,{children:(I=u.getRowModel().rows)!=null&&I.length?u.getRowModel().rows.map(c=>e.jsx(v,{"data-state":c.getIsSelected()&&"selected",children:c.getVisibleCells().map(o=>e.jsx(F,{children:k(o.column.columnDef.cell,o.getContext())},o.id))},c.id)):e.jsx(v,{children:e.jsx(F,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Oe,{table:u})]})}function g({column:s,title:a,className:l}){return s.getCanSort()?e.jsx("div",{className:w("flex items-center space-x-2",l),children:e.jsxs(S,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(r,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:a}),s.getIsSorted()==="desc"?e.jsx(y,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(R,{className:"ml-2 h-4 w-4"}):e.jsx(ve,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(b,{align:"start",children:[e.jsxs(p,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(R,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(p,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(y,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(P,{}),e.jsxs(p,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(ye,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:w(l),children:a})}const Ze=m.object({id:m.number(),name:m.string(),pricePerSms:m.any(),billingCycle:m.enum(["DAILY","WEEKLY","MONTHLY","YEARLY"]),customerVisible:m.boolean(),popular:m.boolean()}),es=({id:s,name:a,onClose:l})=>{const i=q(),t=Qe({mutationFn:async()=>await E.deletePlan(s),onSuccess:()=>{D.success("Plan deleted successfully"),i.invalidateQueries({queryKey:["plans"]}),l()},onError:d=>{var f,C;const x=((C=(f=d==null?void 0:d.response)==null?void 0:f.data)==null?void 0:C.message)||"Failed to delete plan";D.error(x)}}),n=()=>{t.mutate()};return e.jsx(Be,{open:!0,onOpenChange:l,children:e.jsxs(qe,{children:[e.jsxs(Ye,{children:[e.jsx(Ue,{children:"Delete Plan"}),e.jsxs(Ge,{children:["Are you sure you want to delete the plan ",e.jsx("strong",{children:a}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(r,{variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(r,{variant:"destructive",loading:t.isPending,onClick:n,disabled:t.isPending,children:"Delete"})]})]})})};function ss({row:s}){const a=Ze.parse(s.original),l=A(),[i,t]=h.useState(!1);return e.jsxs(S,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(r,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(b,{align:"end",className:"w-[160px]",children:[e.jsx(p,{onClick:()=>{l("/plans/add",{state:{record:a}})},children:"Edit"}),e.jsx(P,{}),e.jsx(p,{onClick:()=>{t(!0)},children:"Delete"})]}),i&&e.jsx(es,{id:a.id,name:a.name,onClose:()=>t(!1)})]})}const as=[{id:"select",header:({table:s})=>e.jsx(T,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(T,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(g,{column:s,title:"#"}),cell:({row:s})=>e.jsx("div",{className:"w-[80px]",children:s.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:s})=>e.jsx(g,{column:s,title:"Name"}),cell:({row:s})=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("name")})})},{accessorKey:"billingCycle",header:({column:s})=>e.jsx(g,{column:s,title:"Billing cycle"}),cell:({row:s})=>e.jsx("div",{className:"w-[100px]",children:s.getValue("billingCycle")})},{accessorKey:"popular",header:({column:s})=>e.jsx(g,{column:s,title:"Popular"}),cell:({row:s})=>e.jsx(j,{variant:s.getValue("popular")?"default":"secondary",children:s.getValue("popular")?"Yes":"No"})},{accessorKey:"pricePerSms",header:({column:s})=>e.jsx(g,{column:s,title:"Price per sms"}),cell:({row:s})=>e.jsx("div",{className:"w-[100px]",children:s.getValue("pricePerSms")})},{accessorKey:"popular",header:({column:s})=>e.jsx(g,{column:s,title:"Customer Visible"}),cell:({row:s})=>e.jsx(j,{variant:s.getValue("customerVisible")?"default":"secondary",children:s.getValue("customerVisible")?"Yes":"No"})},{id:"actions",cell:({row:s})=>e.jsx(ss,{row:s})}];function ks(){const[s,a]=h.useState({pageIndex:0,pageSize:10}),{data:l,isLoading:i}=Q({queryKey:["plans",s.pageIndex,s.pageSize],queryFn:async()=>await E.getPlans({page:s.pageIndex,size:s.pageSize})||[],retry:2,staleTime:5*60*1e3});return e.jsxs(N,{children:[e.jsxs(N.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx($,{}),e.jsx(W,{})]})]}),e.jsxs(N.Body,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Plans"}),e.jsx("p",{className:"text-muted-foreground",children:"Here's a list of all plans"})]})}),i?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(Xe,{data:l||[],columns:as,pagination:s,onPaginationChange:a,totalElements:(l==null?void 0:l.totalElements)||0})})]})]})}export{ks as default};
