import{m as e,l as t,y as s,r as n,g as a,j as r,B as l}from"./index-DgsANLC3.js";import{u as o}from"./index.esm-3KLEzfMo.js";import{t as i}from"./zod-8yhIYjTx.js";import{F as c,a as u,b as m,c as d,d as p,e as f}from"./form-CU8rwvsz.js";import{I as j}from"./input-BaSBk-Gd.js";import{S as x}from"./react-select.esm-DN-60AWJ.js";import{T as v}from"./textarea-B6_lc-Cl.js";import{u as h,L as g}from"./use-auth-store-DlB6JPqf.js";import{S as y,T as S,U as T}from"./user-nav-BjY9odv6.js";import{z as C}from"./index-B0zZW6rS.js";import{u as b}from"./useMutation-Bxa_RUaj.js";import{t as I}from"./template.service-B_nG4bwh.js";import"./label-BTdkY-TR.js";import"./index-D_xSc7Or.js";import"./extends-DPdBf6DS.js";import"./index-D9Jk-2g6.js";import"./Combination-BCJfLLTG.js";import"./index-8bOQzAwE.js";import"./index-ccUYw2Nl.js";import"./index-ByCmscx5.js";import"./index-BuCM2Ckj.js";import"./index-BQ1RgSiI.js";import"./instance-SAW19xTi.js";const N=B;function B(e,t){const s=F();return(B=function(e,t){return s[e-=442]})(e,t)}!function(){const e=B,t=F();for(;;)try{if(640005===-parseInt(e(454))/1+parseInt(e(459))/2+parseInt(e(447))/3*(-parseInt(e(450))/4)+-parseInt(e(446))/5*(-parseInt(e(451))/6)+-parseInt(e(445))/7*(-parseInt(e(448))/8)+parseInt(e(457))/9+-parseInt(e(449))/10)break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const E=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s.apply(t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,(function(){const e=B,t={FjTPI:"(((.+)+)+)+$"};return E[e(458)]().search(t.FjTPI)[e(458)]().constructor(E)[e(444)](t[e(442)])}));function F(){const e=["static","9331686UuAyYC","toString","1876632qmReRh","FjTPI","object","search","14987knmVBj","753715fTfREq","446553LMNgiG","16VefGOF","8932560bIrBqT","4kJPvLE","30lAeKxW","enum","string","1051055BmrxvH","dynamic"];return(F=function(){return e})()}E();const M=C[N(443)]({message:C[N(453)](),messageType:C[N(452)]([N(455),N(456)]),name:C[N(453)]()});!function(){const e=P,t=q();for(;;)try{if(305507===-parseInt(e(198))/1*(parseInt(e(172))/2)+parseInt(e(174))/3+parseInt(e(177))/4+parseInt(e(187))/5+parseInt(e(197))/6+-parseInt(e(192))/7+-parseInt(e(199))/8*(parseInt(e(183))/9))break;t.push(t.shift())}catch(s){t.push(t.shift())}}();const R=function(){let e=!0;return function(t,s){const n=e?function(){if(s){const e=s[P(184)](t,arguments);return s=null,e}}:function(){};return e=!1,n}}()(void 0,(function(){const e=P;return R.toString()[e(178)]("(((.+)+)+)+$").toString()[e(190)](R)[e(178)](e(176))}));function P(e,t){const s=q();return(P=function(e,t){return s[e-=168]})(e,t)}function q(){const e=["3208BcYjQp","OYvSJ","deleteTemplate","HrBtB","updateTemplate","SMS template updated successfully","response","dYkfT","/templates","4966DcXRdX","data","203034HWWpqd","VTTAr","(((.+)+)+)+$","1110288RCHXBv","search","fMHSq","message","Failed to delete SMS template","Failed to update SMS template","16974Dxopte","apply","iQemx","ZYETb","2713860OvCdRC","Failed to create SMS template","GlNbT","constructor","TSJEr","136801SgvRDc","SMS template created successfully","error","smsTemplates","invalidateQueries","1204578bgbdyX","3XRXAdZ"];return(q=function(){return e})()}R();const A=[{value:"ColumnB",label:"Column B"},{value:"ColumnC",label:"Column C"},{value:"ColumnD",label:"Column D"},{value:"ColumnE",label:"Column E"},{value:"ColumnF",label:"Column F"}],H=()=>{var C;const[N,B]=n.useState(0),[E,F]=n.useState([]),R=a(),q=null==(C=null==R?void 0:R.state)?void 0:C.record,{user:H}=h(),{createTemplate:k,updateTemplate:Y}=(()=>{const n=P,a={HrBtB:function(e,t){return e(t)},OYvSJ:n(171),dYkfT:"smsTemplates",VTTAr:n(193),owpue:function(e,t){return e(t)},GlNbT:n(168),fMHSq:function(e,t){return e(t)},TSJEr:"SMS template deleted successfully",drPzz:n(181),ZYETb:function(e){return e()},yzBpr:function(e){return e()},iQemx:function(e,t){return e(t)}},r=a[n(186)](e),l=a.yzBpr(t);return{createTemplate:b({mutationFn:({data:e})=>I.createTemplate(e),onSuccess:()=>{const e=n;a[e(202)](l,a[e(200)]),r[e(196)]({queryKey:[a[e(170)]]}),s.success(a[e(175)])},onError:e=>{var t,a;const r=n,l=(null==(a=null==(t=null==e?void 0:e[r(169)])?void 0:t[r(173)])?void 0:a[r(180)])||r(188);s[r(194)](l)}}),updateTemplate:a[n(185)](b,{mutationFn:({id:e,data:t})=>I[n(203)](e,t),onSuccess:()=>{const e=n;a.owpue(l,a.OYvSJ),r.invalidateQueries({queryKey:[a[e(170)]]}),s.success(a[e(189)])},onError:e=>{var t,a;const r=n,l=(null==(a=null==(t=null==e?void 0:e[r(169)])?void 0:t.data)?void 0:a[r(180)])||r(182);s[r(194)](l)}}),deleteTemplate:b({mutationFn:e=>I[n(201)](e),onSuccess:()=>{const e=n;a[e(179)](l,a[e(200)]),r[e(196)]({queryKey:[e(195)]}),s.success(a[e(191)])},onError:e=>{var t,r;const l=n,o=(null==(r=null==(t=null==e?void 0:e.response)?void 0:t.data)?void 0:r[l(180)])||a.drPzz;s[l(194)](o)}})}})(),z=t(),V=o({resolver:i(M),defaultValues:q||{message:"",messageType:"static",name:"",dynamicColumn:""}}),D=k.isPending||Y.isPending,J=V.watch("messageType");return r.jsxs(g,{children:[r.jsxs(g.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[r.jsx(y,{}),r.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[r.jsx(S,{}),r.jsx(T,{})]})]}),r.jsx(g.Header,{children:r.jsxs("h1",{className:"text-2xl font-bold",children:[q?"Edit":"Add"," Template"]})}),r.jsx(g.Body,{children:r.jsx(c,{...V,children:r.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:r.jsxs("form",{onSubmit:V.handleSubmit((e=>{var t;const s={...e,customerId:null==(t=null==H?void 0:H.customer)?void 0:t.id,id:null==q?void 0:q.id,dynamicColumn:E.map((e=>e.value)).join(",")};q?Y.mutate({id:null==q?void 0:q.id,data:s}):k.mutate({data:s})})),className:"space-y-6",children:[r.jsx(u,{control:V.control,name:"name",render:({field:e})=>r.jsxs(m,{children:[r.jsx(d,{children:"Name *"}),r.jsx(p,{children:r.jsx(j,{placeholder:"Required",...e})}),r.jsx(f,{})]})}),r.jsx(u,{control:V.control,name:"messageType",render:({field:e})=>r.jsxs(m,{children:[r.jsx(d,{children:"Available Tag"}),r.jsx(p,{children:r.jsx(x,{className:"my-react-select-container",classNamePrefix:"my-react-select",defaultValue:{value:"static",label:"static"},options:[{value:"static",label:"static"},{value:"dynamic",label:"dynamic"}],onChange:t=>{e.onChange(null==t?void 0:t.value),F([])}})})]})}),"dynamic"===J&&r.jsxs(m,{children:[r.jsx(d,{children:"Select Dynamic Column *"}),r.jsx(p,{children:r.jsx(x,{className:"my-react-select-container",classNamePrefix:"my-react-select",options:A,placeholder:"Select Column",value:null,onChange:e=>{if(e){const t=` {${e.value}}`,s=V.getValues("message")+t;V.setValue("message",s),B(s.length),F((t=>t.some((t=>t.value===e.value))?t:[...t,e]))}}})}),0===E.length&&r.jsx(f,{children:"Please select a dynamic column"})]}),r.jsx(u,{control:V.control,name:"message",render:({field:e})=>r.jsxs(m,{children:[r.jsx(d,{children:"Message *"}),r.jsx(p,{children:r.jsx(v,{placeholder:"Enter message...",...e,onChange:t=>{e.onChange(t.target.value),B(t.target.value.length)},maxLength:160})}),r.jsxs("div",{className:"text-sm text-gray-500",children:[160-N," CHARACTERS REMAINING"]}),r.jsx(f,{})]})}),r.jsxs("div",{className:"flex justify-end gap-4",children:[r.jsx(l,{type:"submit",className:"btn-primary",loading:D,disabled:D||"dynamic"===J&&0===E.length,children:"Save"}),r.jsx(l,{type:"button",variant:"outline",onClick:()=>{z("/templates")},children:"Cancel"})]})]})})})})]})};export{H as default};
