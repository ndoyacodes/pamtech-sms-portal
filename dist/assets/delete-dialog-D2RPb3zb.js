import{j as e,B as s,c as a,l,r as n,m as t,y as i}from"./index-DgsANLC3.js";import{u as o,T as r,a as c,b as d,c as m,f as x,d as h,e as u,g,h as j,i as p,j as v,k as f,l as b}from"./table-DgNG9M6V.js";import{D as N,C as w,d as C,e as y,M as S,Q as P,k,S as F,l as V,m as z,j as R,A as M,P as D,n as I,F as A,f as B,g as G,h as H,E as T}from"./index-8bOQzAwE.js";import{S as q,a as E,b as O,c as Q,d as U}from"./select-B9KeDb6u.js";import{I as $}from"./input-BaSBk-Gd.js";import{D as K,f as _,b as J,c as L,d as W,g as X,a as Y,e as Z}from"./use-auth-store-DlB6JPqf.js";import{B as ee}from"./badge-DkFHinrL.js";import{P as se,a as ae,b as le,C as ne,c as te,d as ie,e as oe,f as re,g as ce,h as de}from"./popover-BfTfSh0J.js";import{S as me}from"./separator-E74WL0Px.js";import{D as xe,a as he,b as ue,c as ge,d as je}from"./dialog-Cxh4_yU0.js";import{u as pe}from"./useMutation-Bxa_RUaj.js";import{c as ve}from"./contacts.service-CB5R8qdu.js";function fe({table:a}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[a.getFilteredSelectedRowModel().rows.length," of"," ",a.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(q,{value:`${a.getState().pagination.pageSize}`,onValueChange:e=>{a.setPageSize(Number(e))},children:[e.jsx(E,{className:"h-8 w-[70px]",children:e.jsx(O,{placeholder:a.getState().pagination.pageSize})}),e.jsx(Q,{side:"top",children:[10,20,30,40,50].map((s=>e.jsx(U,{value:`${s}`,children:s},s)))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",a.getState().pagination.pageIndex+1," of"," ",a.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(s,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(0),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(N,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(w,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(C,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(a.getPageCount()-1),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(y,{className:"h-4 w-4"})]})]})]})]})}function be({table:a}){return e.jsxs(K,{children:[e.jsx(_,{asChild:!0,children:e.jsxs(s,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(J,{align:"end",className:"w-[150px]",children:[e.jsx(L,{children:"Toggle columns"}),e.jsx(W,{}),a.getAllColumns().filter((e=>void 0!==e.accessorFn&&e.getCanHide())).map((s=>e.jsx(X,{className:"capitalize",checked:s.getIsVisible(),onCheckedChange:e=>s.toggleVisibility(!!e),children:s.id},s.id)))]})]})}const Ne=[{value:"backlog",label:"Backlog",icon:P},{value:"todo",label:"Todo",icon:k},{value:"in progress",label:"In Progress",icon:F},{value:"done",label:"Done",icon:V},{value:"canceled",label:"Canceled",icon:z}],we=[{label:"Pending",value:"Pending",icon:R},{label:"Paid",value:"Paid",icon:M}];function Ce({column:l,title:n,options:t}){const i=null==l?void 0:l.getFacetedUniqueValues(),o=new Set(null==l?void 0:l.getFilterValue());return e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(s,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),n,(null==o?void 0:o.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(me,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(ee,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:o.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:o.size>2?e.jsxs(ee,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[o.size," selected"]}):t.filter((e=>o.has(e.value))).map((s=>e.jsx(ee,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:s.label},s.value)))})]})]})}),e.jsx(le,{className:"w-[200px] p-0",align:"start",children:e.jsxs(ne,{children:[e.jsx(te,{placeholder:n}),e.jsxs(ie,{children:[e.jsx(oe,{children:"No results found."}),e.jsx(re,{children:t.map((s=>{const n=o.has(s.value);return e.jsxs(ce,{onSelect:()=>{n?o.delete(s.value):o.add(s.value);const e=Array.from(o);null==l||l.setFilterValue(e.length?e:void 0)},children:[e.jsx("div",{className:a("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",n?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(I,{className:a("h-4 w-4")})}),s.icon&&e.jsx(s.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.label}),(null==i?void 0:i.get(s.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(s.value)})]},s.value)}))}),o.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(de,{}),e.jsx(re,{children:e.jsx(ce,{onSelect:()=>null==l?void 0:l.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function ye({table:a}){var n;const t=a.getState().columnFilters.length>0,i=l();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx($,{placeholder:"Filter phone...",value:(null==(n=a.getColumn("name"))?void 0:n.getFilterValue())??"",onChange:e=>{var s;return null==(s=a.getColumn("title"))?void 0:s.setFilterValue(e.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[a.getColumn("status")&&e.jsx(Ce,{column:a.getColumn("status"),title:"Status",options:Ne}),a.getColumn("priority")&&e.jsx(Ce,{column:a.getColumn("priority"),title:"Status",options:we}),e.jsxs(s,{variant:"default",onClick:()=>i("/upload-phonebook"),className:"h-8 px-2 lg:px-3",children:["Import phone book",e.jsx(A,{className:"ml-2 h-4 w-4"})]})]}),t&&e.jsxs(s,{variant:"ghost",onClick:()=>a.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(B,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(be,{table:a})]})}function Se({columns:s,data:a,pagination:l,onPaginationChange:t,totalElements:i,isIndex:N}){var w;const[C,y]=n.useState({}),[S,P]=n.useState({}),[k,F]=n.useState([]),[V,z]=n.useState([]),R=o({data:a,columns:s,state:{sorting:V,columnVisibility:S,rowSelection:C,columnFilters:k,pagination:l},manualPagination:!0,pageCount:Math.ceil(i/l.pageSize),onPaginationChange:e=>{const s="function"==typeof e?e(l):e;t(s)},enableRowSelection:!0,onRowSelectionChange:y,onSortingChange:z,onColumnFiltersChange:F,onColumnVisibilityChange:P,getCoreRowModel:b(),getFilteredRowModel:f(),getPaginationRowModel:v(),getSortedRowModel:p(),getFacetedRowModel:j(),getFacetedUniqueValues:g()});return e.jsxs("div",{className:"space-y-4",children:[N&&e.jsx(ye,{table:R}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(r,{children:[e.jsx(c,{children:R.getHeaderGroups().map((s=>e.jsx(d,{children:s.headers.map((s=>e.jsx(m,{colSpan:s.colSpan,children:s.isPlaceholder?null:x(s.column.columnDef.header,s.getContext())},s.id)))},s.id)))}),e.jsx(h,{children:(null==(w=R.getRowModel().rows)?void 0:w.length)?R.getRowModel().rows.map((s=>e.jsx(d,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map((s=>e.jsx(u,{children:x(s.column.columnDef.cell,s.getContext())},s.id)))},s.id))):e.jsx(d,{children:e.jsx(u,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(fe,{table:R})]})}function Pe({column:l,title:n,className:t}){return l.getCanSort()?e.jsx("div",{className:a("flex items-center space-x-2",t),children:e.jsxs(K,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(s,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:n}),"desc"===l.getIsSorted()?e.jsx(M,{className:"ml-2 h-4 w-4"}):"asc"===l.getIsSorted()?e.jsx(G,{className:"ml-2 h-4 w-4"}):e.jsx(H,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(J,{align:"start",children:[e.jsxs(Z,{onClick:()=>l.toggleSorting(!1),children:[e.jsx(G,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(Z,{onClick:()=>l.toggleSorting(!0),children:[e.jsx(M,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(W,{}),e.jsxs(Z,{onClick:()=>l.toggleVisibility(!1),children:[e.jsx(T,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:a(t),children:n})}const ke=({id:a,name:l,onClose:n,type:o})=>{const r=t(),c=pe({mutationFn:async()=>"number"===o?await ve.deletePhoneBookNumber(a):"phonebook"===o?await ve.deletePhoneBook(a):void 0,onSuccess:()=>{i.success("number"===o?"Number deleted successfully":"Phonebook deleted successfully"),r.invalidateQueries({queryKey:["phonebook"]}),n()},onError:e=>{var s,a;const l=(null==(a=null==(s=null==e?void 0:e.response)?void 0:s.data)?void 0:a.message)||"Failed to delete phonebook";i.error(l)}});return e.jsx(xe,{open:!0,onOpenChange:n,children:e.jsxs(he,{children:[e.jsxs(ue,{children:[e.jsx(ge,{children:"number"===o?"Delete Phonebook number":"Delete Phonebook"}),e.jsxs(je,{children:["Are you sure you want to delete this ","number"===o?"number":"phonebook"," ",e.jsx("strong",{children:l}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(s,{variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(s,{variant:"destructive",loading:c.isPending,onClick:()=>{c.mutate()},disabled:c.isPending,children:"Delete"})]})]})})};export{ke as D,Pe as a,Se as b};
