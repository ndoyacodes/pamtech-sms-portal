import{j as e,B as s,c as a,l,r as n,m as t,y as i}from"./index-DgsANLC3.js";import{D as r,f as o,b as c,c as d,d as m,g as x,a as u,e as h,L as g}from"./use-auth-store-DlB6JPqf.js";import{u as j,S as p,T as f,U as v}from"./user-nav-BjY9odv6.js";import{u as N,T as w,a as b,b as C,c as y,f as S,d as P,e as k,g as I,h as V,i as F,j as z,k as R,l as M}from"./table-DgNG9M6V.js";import{D,C as H,d as A,e as E,M as K,Q as T,k as B,S as Y,l as G,m as L,j as q,A as W,P as O,n as U,F as $,f as Q,g as X,h as Z,E as _,i as J}from"./index-8bOQzAwE.js";import{S as ee,a as se,b as ae,c as le,d as ne}from"./select-B9KeDb6u.js";import{I as te}from"./input-BaSBk-Gd.js";import{B as ie}from"./badge-DkFHinrL.js";import{P as re,a as oe,b as ce,C as de,c as me,d as xe,e as ue,f as he,g as ge,h as je}from"./popover-BfTfSh0J.js";import{S as pe}from"./separator-E74WL0Px.js";import{I as fe}from"./IconPlus-CVwxeCme.js";import{C as ve}from"./checkbox-CDTCacFG.js";import{z as Ne}from"./index-B0zZW6rS.js";import{D as we,a as be,b as Ce,c as ye,d as Se}from"./dialog-Cxh4_yU0.js";import{u as Pe}from"./useMutation-Bxa_RUaj.js";import{p as ke}from"./plan.service-VTolrMSm.js";import"./index-D_xSc7Or.js";import"./index-ccUYw2Nl.js";import"./Combination-BCJfLLTG.js";import"./index-ByCmscx5.js";import"./index-BuCM2Ckj.js";import"./index-BQ1RgSiI.js";import"./instance-SAW19xTi.js";import"./index-DCG-2Pmh.js";import"./index-BEsgrMAU.js";import"./extends-DPdBf6DS.js";function Ie({table:a}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[a.getFilteredSelectedRowModel().rows.length," of"," ",a.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(ee,{value:`${a.getState().pagination.pageSize}`,onValueChange:e=>{a.setPageSize(Number(e))},children:[e.jsx(se,{className:"h-8 w-[70px]",children:e.jsx(ae,{placeholder:a.getState().pagination.pageSize})}),e.jsx(le,{side:"top",children:[10,20,30,40,50].map((s=>e.jsx(ne,{value:`${s}`,children:s},s)))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",a.getState().pagination.pageIndex+1," of"," ",a.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(s,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(0),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(D,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(H,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(A,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(a.getPageCount()-1),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(E,{className:"h-4 w-4"})]})]})]})]})}function Ve({table:a}){return e.jsxs(r,{children:[e.jsx(o,{asChild:!0,children:e.jsxs(s,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(c,{align:"end",className:"w-[150px]",children:[e.jsx(d,{children:"Toggle columns"}),e.jsx(m,{}),a.getAllColumns().filter((e=>void 0!==e.accessorFn&&e.getCanHide())).map((s=>e.jsx(x,{className:"capitalize",checked:s.getIsVisible(),onCheckedChange:e=>s.toggleVisibility(!!e),children:s.id},s.id)))]})]})}const Fe=[{value:"backlog",label:"Backlog",icon:T},{value:"todo",label:"Todo",icon:B},{value:"in progress",label:"In Progress",icon:Y},{value:"done",label:"Done",icon:G},{value:"canceled",label:"Canceled",icon:L}],ze=[{label:"Pending",value:"Pending",icon:q},{label:"Paid",value:"Paid",icon:W}];function Re({column:l,title:n,options:t}){const i=null==l?void 0:l.getFacetedUniqueValues(),r=new Set(null==l?void 0:l.getFilterValue());return e.jsxs(re,{children:[e.jsx(oe,{asChild:!0,children:e.jsxs(s,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),n,(null==r?void 0:r.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(pe,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(ie,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:r.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:r.size>2?e.jsxs(ie,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[r.size," selected"]}):t.filter((e=>r.has(e.value))).map((s=>e.jsx(ie,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:s.label},s.value)))})]})]})}),e.jsx(ce,{className:"w-[200px] p-0",align:"start",children:e.jsxs(de,{children:[e.jsx(me,{placeholder:n}),e.jsxs(xe,{children:[e.jsx(ue,{children:"No results found."}),e.jsx(he,{children:t.map((s=>{const n=r.has(s.value);return e.jsxs(ge,{onSelect:()=>{n?r.delete(s.value):r.add(s.value);const e=Array.from(r);null==l||l.setFilterValue(e.length?e:void 0)},children:[e.jsx("div",{className:a("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",n?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(U,{className:a("h-4 w-4")})}),s.icon&&e.jsx(s.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.label}),(null==i?void 0:i.get(s.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(s.value)})]},s.value)}))}),r.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(je,{}),e.jsx(he,{children:e.jsx(ge,{onSelect:()=>null==l?void 0:l.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function Me({table:a}){var n;const t=a.getState().columnFilters.length>0,i=l();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(te,{placeholder:"Filter ...",value:(null==(n=a.getColumn("title"))?void 0:n.getFilterValue())??"",onChange:e=>{var s;return null==(s=a.getColumn("title"))?void 0:s.setFilterValue(e.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[a.getColumn("status")&&e.jsx(Re,{column:a.getColumn("status"),title:"Status",options:Fe}),a.getColumn("priority")&&e.jsx(Re,{column:a.getColumn("priority"),title:"Status",options:ze}),e.jsxs(s,{variant:"default",onClick:()=>i("/plans/add"),className:"h-8 px-2 lg:px-3",children:["Create New plan",e.jsx(fe,{className:"ml-2 h-4 w-4"})]}),e.jsxs(s,{variant:"default",className:"h-8 px-2 lg:px-3",children:["Export",e.jsx($,{className:"ml-2 h-4 w-4"})]})]}),t&&e.jsxs(s,{variant:"ghost",onClick:()=>a.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(Q,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Ve,{table:a})]})}function De({columns:s,data:a,pagination:l,onPaginationChange:t,totalElements:i}){var r;const[o,c]=n.useState({}),[d,m]=n.useState({}),[x,u]=n.useState([]),[h,g]=n.useState([]),j=N({data:a,columns:s,state:{sorting:h,columnVisibility:d,rowSelection:o,columnFilters:x,pagination:l},manualPagination:!0,pageCount:Math.ceil(i/l.pageSize),onPaginationChange:e=>{const s="function"==typeof e?e(l):e;t(s)},enableRowSelection:!0,onRowSelectionChange:c,onSortingChange:g,onColumnFiltersChange:u,onColumnVisibilityChange:m,getCoreRowModel:M(),getFilteredRowModel:R(),getPaginationRowModel:z(),getSortedRowModel:F(),getFacetedRowModel:V(),getFacetedUniqueValues:I()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Me,{table:j}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(w,{children:[e.jsx(b,{children:j.getHeaderGroups().map((s=>e.jsx(C,{children:s.headers.map((s=>e.jsx(y,{colSpan:s.colSpan,children:s.isPlaceholder?null:S(s.column.columnDef.header,s.getContext())},s.id)))},s.id)))}),e.jsx(P,{children:(null==(r=j.getRowModel().rows)?void 0:r.length)?j.getRowModel().rows.map((s=>e.jsx(C,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map((s=>e.jsx(k,{children:S(s.column.columnDef.cell,s.getContext())},s.id)))},s.id))):e.jsx(C,{children:e.jsx(k,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Ie,{table:j})]})}function He({column:l,title:n,className:t}){return l.getCanSort()?e.jsx("div",{className:a("flex items-center space-x-2",t),children:e.jsxs(r,{children:[e.jsx(u,{asChild:!0,children:e.jsxs(s,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:n}),"desc"===l.getIsSorted()?e.jsx(W,{className:"ml-2 h-4 w-4"}):"asc"===l.getIsSorted()?e.jsx(X,{className:"ml-2 h-4 w-4"}):e.jsx(Z,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(c,{align:"start",children:[e.jsxs(h,{onClick:()=>l.toggleSorting(!1),children:[e.jsx(X,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(h,{onClick:()=>l.toggleSorting(!0),children:[e.jsx(W,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(m,{}),e.jsxs(h,{onClick:()=>l.toggleVisibility(!1),children:[e.jsx(_,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:a(t),children:n})}const Ae=Te;!function(){const e=Te,s=Ke();for(;;)try{if(780940===-parseInt(e(270))/1+-parseInt(e(258))/2*(parseInt(e(257))/3)+parseInt(e(274))/4*(parseInt(e(262))/5)+-parseInt(e(273))/6+parseInt(e(261))/7+parseInt(e(256))/8+-parseInt(e(267))/9*(-parseInt(e(269))/10))break;s.push(s.shift())}catch(a){s.push(s.shift())}}();const Ee=function(){let e=!0;return function(s,a){const l=e?function(){if(a){const e=a.apply(s,arguments);return a=null,e}}:function(){};return e=!1,l}}()(void 0,(function(){const e=Te,s={tBWdw:e(278)};return Ee[e(277)]().search(s[e(272)])[e(277)]()[e(264)](Ee)[e(260)](s[e(272)])}));function Ke(){const e=["(((.+)+)+)+$","DAILY","7432720jwuZYx","2229tFouSh","1180TixtWH","string","search","111167alMnky","5zZisld","object","constructor","boolean","number","18378TlWDDo","any","6870OgMrme","1008318kjRmpk","enum","tBWdw","6460884SmGXud","3826468UHtzjj","MONTHLY","YEARLY","toString"];return(Ke=function(){return e})()}function Te(e,s){const a=Ke();return(Te=function(e,s){return a[e-=256]})(e,s)}Ee();const Be=Ne[Ae(263)]({id:Ne[Ae(266)](),name:Ne[Ae(259)](),pricePerSms:Ne[Ae(268)](),billingCycle:Ne[Ae(271)]([Ae(279),"WEEKLY",Ae(275),Ae(276)]),customerVisible:Ne.boolean(),popular:Ne[Ae(265)]()}),Ye=({id:a,name:l,onClose:n})=>{const r=t(),o=Pe({mutationFn:async()=>await ke.deletePlan(a),onSuccess:()=>{i.success("Plan deleted successfully"),r.invalidateQueries({queryKey:["plans"]}),n()},onError:e=>{var s,a;const l=(null==(a=null==(s=null==e?void 0:e.response)?void 0:s.data)?void 0:a.message)||"Failed to delete plan";i.error(l)}});return e.jsx(we,{open:!0,onOpenChange:n,children:e.jsxs(be,{children:[e.jsxs(Ce,{children:[e.jsx(ye,{children:"Delete Plan"}),e.jsxs(Se,{children:["Are you sure you want to delete the plan ",e.jsx("strong",{children:l}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(s,{variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(s,{variant:"destructive",loading:o.isPending,onClick:()=>{o.mutate()},disabled:o.isPending,children:"Delete"})]})]})})};function Ge({row:a}){const t=Be.parse(a.original),i=l(),[o,d]=n.useState(!1);return e.jsxs(r,{children:[e.jsx(u,{asChild:!0,children:e.jsxs(s,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(c,{align:"end",className:"w-[160px]",children:[e.jsx(h,{onClick:()=>{i("/plans/add",{state:{record:t}})},children:"Edit"}),e.jsx(m,{}),e.jsx(h,{onClick:()=>{d(!0)},children:"Delete"})]}),o&&e.jsx(Ye,{id:t.id,name:t.name,onClose:()=>d(!1)})]})}const Le=[{id:"select",header:({table:s})=>e.jsx(ve,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(ve,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(He,{column:s,title:"#"}),cell:({row:s})=>e.jsx("div",{className:"w-[80px]",children:s.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:s})=>e.jsx(He,{column:s,title:"Name"}),cell:({row:s})=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("name")})})},{accessorKey:"billingCycle",header:({column:s})=>e.jsx(He,{column:s,title:"Billing cycle"}),cell:({row:s})=>e.jsx("div",{className:"w-[100px]",children:s.getValue("billingCycle")})},{accessorKey:"popular",header:({column:s})=>e.jsx(He,{column:s,title:"Popular"}),cell:({row:s})=>e.jsx(ie,{variant:s.getValue("popular")?"default":"secondary",children:s.getValue("popular")?"Yes":"No"})},{accessorKey:"pricePerSms",header:({column:s})=>e.jsx(He,{column:s,title:"Price per sms"}),cell:({row:s})=>e.jsx("div",{className:"w-[100px]",children:s.getValue("pricePerSms")})},{accessorKey:"popular",header:({column:s})=>e.jsx(He,{column:s,title:"Customer Visible"}),cell:({row:s})=>e.jsx(ie,{variant:s.getValue("customerVisible")?"default":"secondary",children:s.getValue("customerVisible")?"Yes":"No"})},{id:"actions",cell:({row:s})=>e.jsx(Ge,{row:s})}];function qe(){const[s,a]=n.useState({pageIndex:0,pageSize:10}),{data:l,isLoading:t}=j({queryKey:["plans",s.pageIndex,s.pageSize],queryFn:async()=>await ke.getPlans({page:s.pageIndex,size:s.pageSize})||[],retry:2,staleTime:3e5});return e.jsxs(g,{children:[e.jsxs(g.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(p,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(f,{}),e.jsx(v,{})]})]}),e.jsxs(g.Body,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Plans"}),e.jsx("p",{className:"text-muted-foreground",children:"Here's a list of all plans"})]})}),t?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(De,{data:l||[],columns:Le,pagination:s,onPaginationChange:a,totalElements:(null==l?void 0:l.totalElements)||0})})]})]})}export{qe as default};
