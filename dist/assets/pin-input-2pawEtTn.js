import{r as e,j as t,c as n}from"./index-DgsANLC3.js";const a=e.createContext(!1),l=e.forwardRef((({className:n,children:l,...i},s)=>{const{defaultValue:f,value:p,onChange:d,onComplete:h,onIncomplete:m,placeholder:y="â—‹",type:g="alphanumeric",name:v,form:w,otp:D=!1,mask:b=!1,disabled:x=!1,readOnly:C=!1,autoFocus:E=!1,ariaLabel:N="",...A}=i,P=o(l),V=c(l),{pins:K,pinValue:j,refMap:$,...k}=u({value:p,defaultValue:f,placeholder:y,type:g,length:V,readOnly:C});e.useEffect((()=>{d&&d(j)}),[d,j]),e.useEffect((()=>{h&&j.length===V&&h(j),m&&j.length!==V&&m(j)}),[V,h,m,j]),e.useEffect((()=>{if(!E)return;const e=null==$?void 0:$.get(0);e&&e.focus()}),[E,$]);const R=e.useRef(0);let B=0;const F=P.map((t=>{if(t.type===r){const n=B;return B+=1,e.cloneElement(t,{name:v,inputKey:`input-${n}`,value:V>n?K[n]:"",onChange:e=>k.handleChange(e,n),onFocus:e=>k.handleFocus(e,n),onBlur:()=>k.handleBlur(n),onKeyDown:e=>k.handleKeyDown(e,n),onPaste:e=>k.handlePaste(e),placeholder:y,type:g,mask:b,autoComplete:D?"one-time-code":"off",disabled:x,readOnly:C,"aria-label":N||`Pin input ${B} of ${V}`,ref:e=>{e?null==$||$.set(n,e):null==$||$.delete(n)}})}return R.current=R.current+1,t}));return t.jsx(a.Provider,{value:!0,children:t.jsxs("div",{ref:s,"aria-label":"Pin Input",className:n,...A,children:[F,t.jsx("input",{type:"hidden",name:v,form:w,value:j})]})})}));l.displayName="PinInput";const r=e.forwardRef((({className:r,component:u,...o},c)=>{const{mask:i,type:s,inputKey:f,...p}=o;if(!e.useContext(a))throw new Error(`PinInputField must be used within ${l.displayName}.`);const d=u||"input";return t.jsx(d,{ref:c,type:i?"password":"numeric"===s?"tel":"text",inputMode:"numeric"===s?"numeric":"text",className:n("size-10 text-center",r),...p},f)})),u=({value:t,defaultValue:n,placeholder:a,type:l,length:r,readOnly:u})=>{const o=e.useMemo((()=>Array.from({length:r},((e,a)=>n?n.charAt(a):t?t.charAt(a):""))),[n,r,t]),[c,i]=e.useState(o),s=c.join("").trim();e.useEffect((()=>{i(o)}),[o]);const f=e.useRef(null);function p(){return f.current||(f.current=new Map),f.current}function d(e){const t=p();return null==t?void 0:t.get(e)}function h(e){const t=d(e);t&&(t.focus(),t.placeholder="")}function m(e,t){const n=d(t);n&&(n.value=e),i((n=>n.map(((n,a)=>a===t?e:n))))}function y(e){return("alphanumeric"===l?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(e)}const g=e.useRef(null);return{pins:c,pinValue:s,refMap:p(),handleFocus:function(e,t){e.target.select(),h(t)},handleBlur:function(e){const t=d(e);t&&(t.placeholder=a)},handleChange:function(e,t){const n=e.target.value,a=g.current,l=a&&a.length===r?a.charAt(r-1):n.slice(-1);y(l)&&(m(l,t),g.current=null,n.length>0&&h(t+1))},handlePaste:function(e){e.preventDefault();const t=e.clipboardData.getData("text/plain").replace(/[\n\r\s]+/g,""),n=t.split("").slice(0,r);if(n.every((e=>y(e)))){for(let e=0;e<r;e++)e<n.length&&m(n[e],e);g.current=t,h(n.length<r?n.length:r-1)}},handleKeyDown:function(e,t){const{ctrlKey:n,key:a,shiftKey:r,metaKey:o}=e;if("numeric"===l){(!!("Backspace"===a||"Tab"===a||"Control"===a||"Delete"===a||n&&"v"===a||o&&"v"===a)||!Number.isNaN(Number(a)))&&!u||e.preventDefault()}"ArrowLeft"===a||r&&"Tab"===a?(e.preventDefault(),h(t-1)):"ArrowRight"===a||"Tab"===a||" "===a?(e.preventDefault(),h(t+1)):"Delete"===a?e.preventDefault():"Backspace"===a&&(e.preventDefault(),m("",t),""===e.target.value&&h(t-1))}}},o=t=>e.Children.toArray(t).filter((t=>{if(e.isValidElement(t))return e.isValidElement(t);throw new Error(`${l.displayName} contains invalid children.`)})),c=t=>e.Children.toArray(t).filter((t=>{if(e.isValidElement(t)&&t.type===r)return e.isValidElement(t)})).length;export{l as P,r as a};
