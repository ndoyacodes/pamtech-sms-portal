import{j as e,B as c,c as S,k as K,r as h,y}from"./index-d9TgJTTy.js";import{D as P,f as U,b as R,c as G,d as D,g as Y,u as k,a as B,e as p,m as $,L as b}from"./use-auth-store-CiawQdvf.js";import{u as J,S as Q,T as W,U as _}from"./user-nav-1-09pvFT.js";import{u as X,g as Z,a as ee,b as se,c as ae,d as te,e as ne,T as le,f as re,h as I,i as ie,j as A,k as ce,l as V}from"./table-DaUOpY8m.js";import{D as oe,C as de,d as me,e as xe,M as ge,P as he,n as ue,F as pe,f as je,A as F,g as E,h as fe,E as ve,i as we}from"./index-CD610jSn.js";import{S as Ce,a as Se,b as Ne,c as ye,d as be}from"./select-cMMktxW9.js";import{I as Ie}from"./input-DpwfBUf3.js";import{B as C}from"./badge-DjWKEn-0.js";import{P as Pe,a as Re,b as De,C as ke,c as Me,d as Ae,e as Ve,f as T,g as z,h as Fe}from"./popover-CnlP89lX.js";import{S as Ee}from"./separator-BUjyEJiy.js";import{I as Te}from"./IconPlus-DdfCuiNF.js";import{C as H}from"./checkbox-BGteumho.js";import{z as o}from"./index-C3hmKdn7.js";import{D as ze}from"./delete-aKM04Y6L.js";import{D as He,a as Le,b as Oe,c as qe,d as Ke}from"./dialog-BlA-gPk4.js";import{L as Be}from"./label-BkzUlrRU.js";import{T as Ue}from"./textarea-DzV--754.js";import{u as Ge}from"./senderid-hook-CbylRA8w.js";import{s as L}from"./senderid.services-oF-ok74q.js";import"./index-Chc_HW3c.js";import"./index-EIcx_2LO.js";import"./Combination-D2mTRfsA.js";import"./index-LU4gLCaG.js";import"./index-DT5heVsp.js";import"./index-BIPiAFp5.js";import"./instance-BGpPafi2.js";import"./index-W6PM2pC6.js";import"./index-BCvMni3w.js";import"./extends-CF3RwP-h.js";import"./useMutation-scFYzLXQ.js";function Ye({table:s}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(Ce,{value:`${s.getState().pagination.pageSize}`,onValueChange:a=>{s.setPageSize(Number(a))},children:[e.jsx(Se,{className:"h-8 w-[70px]",children:e.jsx(Ne,{placeholder:s.getState().pagination.pageSize})}),e.jsx(ye,{side:"top",children:[10,20,30,40,50].map(a=>e.jsx(be,{value:`${a}`,children:a},a))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(c,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(oe,{className:"h-4 w-4"})]}),e.jsxs(c,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(de,{className:"h-4 w-4"})]}),e.jsxs(c,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(me,{className:"h-4 w-4"})]}),e.jsxs(c,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(xe,{className:"h-4 w-4"})]})]})]})]})}function $e({table:s}){return e.jsxs(P,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(R,{align:"end",className:"w-[150px]",children:[e.jsx(G,{children:"Toggle columns"}),e.jsx(D,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx(Y,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:n=>a.toggleVisibility(!!n),children:a.id},a.id))]})]})}function Je({column:s,title:a,options:n}){const l=s==null?void 0:s.getFacetedUniqueValues(),r=new Set(s==null?void 0:s.getFilterValue());return e.jsxs(Pe,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),a,(r==null?void 0:r.size)>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ee,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(C,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:r.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:r.size>2?e.jsxs(C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[r.size," selected"]}):n.filter(t=>r.has(t.value)).map(t=>e.jsx(C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:t.label},t.value))})]})]})}),e.jsx(De,{className:"w-[200px] p-0",align:"start",children:e.jsxs(ke,{children:[e.jsx(Me,{placeholder:a}),e.jsxs(Ae,{children:[e.jsx(Ve,{children:"No results found."}),e.jsx(T,{children:n.map(t=>{const i=r.has(t.value);return e.jsxs(z,{onSelect:()=>{i?r.delete(t.value):r.add(t.value);const d=Array.from(r);s==null||s.setFilterValue(d.length?d:void 0)},children:[e.jsx("div",{className:S("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",i?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(ue,{className:S("h-4 w-4")})}),t.icon&&e.jsx(t.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:t.label}),(l==null?void 0:l.get(t.value))&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:l.get(t.value)})]},t.value)})}),r.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{}),e.jsx(T,{children:e.jsx(z,{onSelect:()=>s==null?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function Qe({table:s}){var r;const a=s.getState().columnFilters.length>0,n=K(),{user:l}=k();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(Ie,{placeholder:"Filter Sender Ids...",value:((r=s.getColumn("name"))==null?void 0:r.getFilterValue())??"",onChange:t=>{var i;return(i=s.getColumn("name"))==null?void 0:i.setFilterValue(t.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[s.getColumn("status")&&e.jsx(Je,{column:s.getColumn("status"),title:"Status",options:[{label:"Active",value:"Active"},{label:"Inactive",value:"Inactive"}]}),(l==null?void 0:l.customer)&&e.jsxs(c,{variant:"default",onClick:()=>n("/sender-ids/add"),className:"h-8 px-2 lg:px-3",children:["Create New Sender ID",e.jsx(Te,{className:"ml-2 h-4 w-4"})]}),e.jsxs(c,{variant:"default",className:"h-8 px-2 lg:px-3",children:["Export",e.jsx(pe,{className:"ml-2 h-4 w-4"})]})]}),a&&e.jsxs(c,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(je,{className:"ml-2 h-4 w-4"})]})]}),e.jsx($e,{table:s})]})}function We({columns:s,data:a,pagination:n,onPaginationChange:l,totalElements:r}){var M;const[t,i]=h.useState({}),[d,u]=h.useState({}),[v,m]=h.useState([]),[j,N]=h.useState([]),w=X({data:a,columns:s,state:{sorting:j,columnVisibility:d,rowSelection:t,columnFilters:v,pagination:n},manualPagination:!0,pageCount:Math.ceil(r/n.pageSize),onPaginationChange:g=>{const x=typeof g=="function"?g(n):g;l(x)},enableRowSelection:!0,onRowSelectionChange:i,onSortingChange:N,onColumnFiltersChange:m,onColumnVisibilityChange:u,getCoreRowModel:Z(),getFilteredRowModel:ee(),getPaginationRowModel:se(),getSortedRowModel:ae(),getFacetedRowModel:te(),getFacetedUniqueValues:ne()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Qe,{table:w}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(le,{children:[e.jsx(re,{children:w.getHeaderGroups().map(g=>e.jsx(I,{children:g.headers.map(x=>e.jsx(ie,{colSpan:x.colSpan,children:x.isPlaceholder?null:A(x.column.columnDef.header,x.getContext())},x.id))},g.id))}),e.jsx(ce,{children:(M=w.getRowModel().rows)!=null&&M.length?w.getRowModel().rows.map(g=>e.jsx(I,{"data-state":g.getIsSelected()&&"selected",children:g.getVisibleCells().map(x=>e.jsx(V,{children:A(x.column.columnDef.cell,x.getContext())},x.id))},g.id)):e.jsx(I,{children:e.jsx(V,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Ye,{table:w})]})}function f({column:s,title:a,className:n}){return s.getCanSort()?e.jsx("div",{className:S("flex items-center space-x-2",n),children:e.jsxs(P,{children:[e.jsx(B,{asChild:!0,children:e.jsxs(c,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:a}),s.getIsSorted()==="desc"?e.jsx(F,{className:"ml-2 h-4 w-4"}):s.getIsSorted()==="asc"?e.jsx(E,{className:"ml-2 h-4 w-4"}):e.jsx(fe,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(R,{align:"start",children:[e.jsxs(p,{onClick:()=>s.toggleSorting(!1),children:[e.jsx(E,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(p,{onClick:()=>s.toggleSorting(!0),children:[e.jsx(F,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(D,{}),e.jsxs(p,{onClick:()=>s.toggleVisibility(!1),children:[e.jsx(ve,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:S(n),children:a})}const O=o.object({id:o.number(),senderId:o.string(),price:o.number(),billingCycle:o.enum(["DAILY","WEEKLY","MONTHLY","YEARLY","CUSTOM"]),status:o.boolean(),approvalStatus:o.string(),createdAt:o.string(),updatedAt:o.string(),activated:o.any(),customer:o.any(),user:o.any()}),q=({senderId:s,actionType:a,onClose:n})=>{const[l,r]=h.useState(""),{approveSenderId:t}=Ge(),i=async()=>{if(a==="REJECT"&&!l.trim()){y.error("Remarks are required for rejection.");return}const d=a==="APPROVE";t.mutate({data:{id:s,remarks:"remarks",approved:d}},{onSuccess:()=>{y.success(d?"Sender Id approved successfully!":"Sender Id rejected successfully!"),n()},onError:u=>{var m,j;const v=((j=(m=u==null?void 0:u.response)==null?void 0:m.data)==null?void 0:j.message)||"Failed to process the request.";y.error(v)}})};return e.jsx(He,{open:!0,onOpenChange:n,children:e.jsxs(Le,{children:[e.jsxs(Oe,{children:[e.jsx(qe,{children:"Senderr Id Approval"}),e.jsx(Ke,{children:a==="APPROVE"?"Are you sure you want to approve this sender name?":"Are you sure you want to reject this sender name? This action is irreversible."})]}),e.jsx("div",{className:"space-y-4 py-4",children:a==="REJECT"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Be,{htmlFor:"remarks",children:"Remarks"}),e.jsx(Ue,{id:"remarks",placeholder:"Enter remarks",value:l,onChange:d=>r(d.target.value),required:!0})]})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(c,{variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(c,{variant:a==="APPROVE"?"default":"destructive",loading:t.isPending,onClick:i,disabled:t.isPending,children:a==="APPROVE"?"Approve":"Reject"})]})]})})};function _e({row:s}){const a=O.parse(s.original),[n,l]=h.useState(!1),r=O.parse(s.original).senderId,[t,i]=h.useState(!1),[d,u]=h.useState(!1),v=K(),{user:m}=k(),j=()=>{i(!1)},N=()=>{u(!1)};return e.jsxs(P,{children:[e.jsx(B,{asChild:!0,children:e.jsxs(c,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(R,{align:"end",className:"w-[160px]",children:[e.jsx(p,{onClick:()=>{v(`/sender-ids/details/${a.id}`)},children:"View"}),!(m!=null&&m.customer)&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>i(!0),children:"Approve"}),e.jsx(p,{onClick:()=>u(!0),children:"Reject"}),e.jsx(p,{children:"Delete"})]}),e.jsx(D,{}),(m==null?void 0:m.customer)&&e.jsxs(p,{onClick:()=>{l(!0)},children:["Delete",e.jsx($,{children:"⌘⌫"})]})]}),n&&e.jsx(ze,{id:a.id,name:r,onClose:()=>l(!1)}),t&&e.jsx(q,{senderId:a==null?void 0:a.id,actionType:"APPROVE",onClose:j}),d&&e.jsx(q,{senderId:a==null?void 0:a.id,actionType:"REJECT",onClose:N})]})}const Xe=[{id:"select",header:({table:s})=>e.jsx(H,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(H,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(f,{column:s,title:"#"}),cell:({row:s})=>e.jsx("div",{className:"w-[80px]",children:s.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"senderId",header:({column:s})=>e.jsx(f,{column:s,title:"Sender Id"}),cell:({row:s})=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("senderId")})}),enableSorting:!0,enableHiding:!1},{accessorKey:"billingCycle",header:({column:s})=>e.jsx(f,{column:s,title:"Billing Cycle"}),cell:({row:s})=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("billingCycle")})}),enableSorting:!0,enableHiding:!0},{accessorKey:"price",header:({column:s})=>e.jsx(f,{column:s,title:"  Price"}),cell:({row:s})=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("price")})}),enableSorting:!0,enableHiding:!1},{accessorKey:"approvalStatus",header:({column:s})=>e.jsx(f,{column:s,title:"Approval"}),cell:({row:s})=>e.jsx(C,{variant:s.getValue("approvalStatus")==="PENDING"||s.getValue("approvalStatus")===null?"secondary":s.getValue("approvalStatus")==="APPROVED"?"success":"destructive",children:s.getValue("approvalStatus")})},{accessorKey:"activated",header:({column:s})=>e.jsx(f,{column:s,title:"Status"}),cell:({row:s})=>{const a=s.getValue("activated");return e.jsx("div",{className:"flex w-[100px] items-center",children:e.jsx(C,{variant:a?"success":"destructive",children:a?"Active":"Inactive"})})}},{id:"actions",cell:({row:s})=>e.jsx(_e,{row:s})}];function Ds(){const[s,a]=h.useState({pageIndex:0,pageSize:10}),{user:n}=k(),{data:l,isLoading:r}=J({queryKey:["sender-ids",s.pageIndex,s.pageSize],queryFn:async()=>{if(n!=null&&n.customer){const i=await L.getCustomerSenderIds({page:s.pageIndex,size:s.pageSize});return i||{content:i.content||[],totalElements:i==null?void 0:i.totalElements}}const t=await L.getSenderIds({page:s.pageIndex,size:s.pageSize});return t||{content:t.content||[],totalElements:t==null?void 0:t.totalElements}},retry:2,staleTime:5*60*1e3});return e.jsxs(b,{children:[e.jsxs(b.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(Q,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(W,{}),e.jsx(_,{})]})]}),e.jsxs(b.Body,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Sender Ids"}),e.jsx("p",{className:"text-muted-foreground",children:"Here's a list of your Sender Ids"})]})}),r?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(We,{data:l==null?void 0:l.content,columns:Xe,pagination:s,onPaginationChange:a,totalElements:(l==null?void 0:l.totalElements)||0})})]})]})}export{Ds as default};
