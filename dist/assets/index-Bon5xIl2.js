import{j as e,B as s}from"./index-DgsANLC3.js";import{u as a}from"./index.esm-3KLEzfMo.js";import{z as n}from"./index-B0zZW6rS.js";import{t as i}from"./zod-8yhIYjTx.js";import{F as t,a as l,b as r,c as o,d as m,e as d}from"./form-CU8rwvsz.js";import{I as c}from"./input-BaSBk-Gd.js";import{L as u}from"./use-auth-store-DlB6JPqf.js";import{u as j,S as p,T as x,U as h}from"./user-nav-BjY9odv6.js";import{S as f}from"./react-select.esm-DN-60AWJ.js";import{p as v}from"./plan.service-VTolrMSm.js";import{u as b}from"./plan-hooks-BSf6LFVi.js";import"./label-BTdkY-TR.js";import"./index-D_xSc7Or.js";import"./index-8bOQzAwE.js";import"./index-ccUYw2Nl.js";import"./Combination-BCJfLLTG.js";import"./index-ByCmscx5.js";import"./index-BuCM2Ckj.js";import"./index-BQ1RgSiI.js";import"./instance-SAW19xTi.js";import"./extends-DPdBf6DS.js";import"./index-D9Jk-2g6.js";import"./useMutation-Bxa_RUaj.js";const y=n.object({planId:n.number().min(1,"Please select a plan"),amount:n.string().min(1,"Please enter amount")}),g=()=>{const{createSubscriptionPlan:n}=b(),g=a({resolver:i(y),defaultValues:{amount:"",planId:0}}),S=g.watch("planId"),N=g.watch("amount"),{data:P,isLoading:I}=j({queryKey:["plans"],queryFn:async()=>await v.getPlans({page:0,size:10})||[],retry:2,staleTime:3e5}),w=null==P?void 0:P.find((e=>e.id===S)),T=w&&N?Math.floor(Number(N)/w.pricePerSms):0;return e.jsxs(u,{children:[e.jsxs(u.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(p,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(x,{}),e.jsx(h,{})]})]}),e.jsx(u.Body,{children:e.jsxs("div",{className:"mx-auto max-w-6xl rounded-md p-8 shadow-md",children:[e.jsx("h2",{className:"mb-6 text-2xl font-semibold",children:"Top Up"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Add balance to your account to send messages"}),e.jsx(t,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit((e=>{n.mutate({data:{planId:e.planId,amount:e.amount}})})),className:"space-y-6",children:[e.jsx(l,{control:g.control,name:"planId",render:({field:s})=>{var a,n;return e.jsxs(r,{children:[e.jsx(o,{children:"Plan"}),e.jsx(m,{children:e.jsx(f,{className:"my-react-select-container",classNamePrefix:"my-react-select",isLoading:I,placeholder:"Select a plan",options:null==P?void 0:P.map((e=>({value:e.id,label:`${e.name} - ${e.pricePerSms} TZS`}))),onChange:e=>s.onChange(null==e?void 0:e.value),value:(null==P?void 0:P.find((e=>e.id===s.value)))?{value:s.value,label:`${null==(a=null==P?void 0:P.find((e=>e.id===s.value)))?void 0:a.name} - ${null==(n=P.find((e=>e.id===s.value)))?void 0:n.pricePerSms} TZS`}:null})}),e.jsx(d,{})]})}}),e.jsx(l,{control:g.control,name:"amount",render:({field:s})=>e.jsxs(r,{children:[e.jsx(o,{children:"Amount (TZS)"}),e.jsx(m,{children:e.jsx(c,{placeholder:"Enter amount",...s,type:"number"})}),e.jsx(d,{})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Number of SMS: ",e.jsx("strong",{children:T})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(s,{type:"submit",loading:n.isPending,disabled:n.isPending,children:"Checkout"})})]})})]})})]})};export{g as CampaignBuilder,g as default};
