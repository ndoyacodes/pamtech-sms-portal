import{b as e,j as s,B as a,r as t,V as n,c as l,l as r,n as i}from"./index-DgsANLC3.js";import{u as o,T as c,a as d,b as m,c as u,f as x,d as h,e as g,g as j,h as p,i as f,j as v,k as w,l as N}from"./table-DgNG9M6V.js";import{D as S,C as D,d as b,e as y,M as C,F as I,A as k,g as E,h as T,E as P,i as R}from"./index-8bOQzAwE.js";import{S as V,a as F,b as A,c as M,d as H}from"./select-B9KeDb6u.js";import{D as Y,f as K,b as z,c as O,d as B,g as L,a as G,e as U}from"./use-auth-store-DlB6JPqf.js";import{z as _}from"./index-B0zZW6rS.js";import{u as Q}from"./index.esm-3KLEzfMo.js";import{t as X}from"./zod-8yhIYjTx.js";import{F as W,a as q,b as $,c as J,d as Z,e as ee}from"./form-CU8rwvsz.js";import{I as se}from"./input-BaSBk-Gd.js";import{u as ae}from"./user-nav-BjY9odv6.js";import{s as te}from"./senderid.services-ChtNoxr4.js";import{B as ne}from"./badge-DkFHinrL.js";import{C as le}from"./checkbox-CDTCacFG.js";
/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var re=e("outline","filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]);function ie({table:e}){return s.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[s.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[e.getFilteredSelectedRowModel().rows.length," of"," ",e.getFilteredRowModel().rows.length," row(s) selected."]}),s.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),s.jsxs(V,{value:`${e.getState().pagination.pageSize}`,onValueChange:s=>{e.setPageSize(Number(s))},children:[s.jsx(F,{className:"h-8 w-[70px]",children:s.jsx(A,{placeholder:e.getState().pagination.pageSize})}),s.jsx(M,{side:"top",children:[10,20,30,40,50].map((e=>s.jsx(H,{value:`${e}`,children:e},e)))})]})]}),s.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",e.getState().pagination.pageIndex+1," of"," ",e.getPageCount()]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(a,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),children:[s.jsx("span",{className:"sr-only",children:"Go to first page"}),s.jsx(S,{className:"h-4 w-4"})]}),s.jsxs(a,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),children:[s.jsx("span",{className:"sr-only",children:"Go to previous page"}),s.jsx(D,{className:"h-4 w-4"})]}),s.jsxs(a,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),children:[s.jsx("span",{className:"sr-only",children:"Go to next page"}),s.jsx(b,{className:"h-4 w-4"})]}),s.jsxs(a,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),children:[s.jsx("span",{className:"sr-only",children:"Go to last page"}),s.jsx(y,{className:"h-4 w-4"})]})]})]})]})}function oe({table:e}){return s.jsxs(Y,{children:[s.jsx(K,{asChild:!0,children:s.jsxs(a,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[s.jsx(C,{className:"mr-2 h-4 w-4"}),"View"]})}),s.jsxs(z,{align:"end",className:"w-[150px]",children:[s.jsx(O,{children:"Toggle columns"}),s.jsx(B,{}),e.getAllColumns().filter((e=>void 0!==e.accessorFn&&e.getCanHide())).map((e=>s.jsx(L,{className:"capitalize",checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),children:e.id},e.id)))]})]})}const ce=_.object({period:_.string().optional(),fromDate:_.string().optional(),toDate:_.string().optional(),direction:_.string().optional(),type:_.string().optional(),status:_.string().optional(),fromAddress:_.string().optional(),messageId:_.string().optional(),senderId:_.number().optional(),recipient:_.string().optional(),msisdn:_.string().optional()}),de=(e,s)=>"senderId"===e?"NUMBER":"fromDate"===e||"toDate"===e?"DATE":"boolean"==typeof s?"BOOLEAN":"number"==typeof s?"NUMBER":"STRING";function me({table:e,onFilterSubmit:l}){const[r,i]=t.useState(!1),[o,c]=t.useState(!1),[d,m]=t.useState(!1),u=Q({resolver:X(ce),defaultValues:{period:"",fromDate:"",toDate:"",status:"",senderId:void 0,msisdn:""}}),x=u.watch("period");t.useEffect((()=>{if(c("CUSTOM"===x),"CUSTOM"!==x){const e=new Date;let s=new Date,a=new Date;switch(x){case"TODAY":s.setHours(0,0,0,0),a.setHours(23,59,59,999);break;case"YESTERDAY":s=new Date(e),s.setDate(e.getDate()-1),s.setHours(0,0,0,0),a=new Date(e),a.setDate(e.getDate()-1),a.setHours(23,59,59,999);break;case"THIS_WEEK":s=new Date(e);const t=e.getDate()-e.getDay();s.setDate(t),s.setHours(0,0,0,0),a=new Date(e),a.setHours(23,59,59,999);break;case"THIS_MONTH":s=new Date(e.getFullYear(),e.getMonth(),1),s.setHours(0,0,0,0),a=new Date(e),a.setHours(23,59,59,999);break;default:s=new Date(0),a=new Date(0)}x?(u.setValue("fromDate",n(s)),u.setValue("toDate",n(a))):(u.setValue("fromDate",""),u.setValue("toDate",""))}}),[x,u]);const{data:h,isLoading:g}=ae({queryKey:["sender-ids"],queryFn:async()=>{var e;const s=await te.getCustomerSenderIds({page:0,size:1e4});return(null==(e=null==s?void 0:s.content)?void 0:e.map((e=>({value:e.id,label:e.senderId}))))||[]}});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex flex-1 flex-col-reverse sm:flex-row sm:items-center sm:space-x-2",children:s.jsxs("div",{className:"flex gap-x-2",children:[s.jsxs(a,{variant:"default",onClick:()=>i(!r),className:"h-8 px-3",children:["Filter ",s.jsx(re,{className:"ml-2 h-4 w-4"})]}),s.jsxs(a,{variant:"default",className:"h-8 px-3",children:["Export ",s.jsx(I,{className:"ml-2 h-4 w-4"})]})]})}),s.jsx(oe,{table:e})]}),r&&s.jsx("div",{className:"mt-4 rounded-lg bg-white p-6 shadow-md",children:s.jsx(W,{...u,children:s.jsxs("form",{onSubmit:u.handleSubmit((async e=>{try{m(!0);const s=Object.entries(e).filter((([s,a])=>"period"!==s&&(!!("fromDate"!==s&&"toDate"!==s||e.fromDate||e.toDate)&&("fromDate"!==s&&"toDate"!==s&&(void 0!==a&&""!==a))))).map((([e,s])=>"msisdn"===e?{key:"recipient",operator:"LIKE",field_type:"STRING",value:s,values:[s]}:"senderId"===e?{key:"sender.id",operator:"EQUAL",field_type:"STRING",value:s,values:[s]}:{key:e,operator:"EQUAL",field_type:de(e,s),value:s,values:[s]}));(e.fromDate||e.toDate)&&s.push({key:"createdAt",operator:"BETWEEN",field_type:"DATE",value:n(e.fromDate)||null,value_to:n(e.toDate)||null,values:[n(e.fromDate)||"",n(e.toDate)||""]});const a={filters:s,sorts:[],page:0,size:10};l&&await l(a)}catch(s){}finally{m(!1)}})),className:"grid grid-cols-1 gap-4 md:grid-cols-6",children:[s.jsx(q,{control:u.control,name:"period",render:({field:e})=>s.jsxs($,{children:[s.jsx(J,{children:"Period"}),s.jsxs(V,{onValueChange:e.onChange,defaultValue:e.value,children:[s.jsx(Z,{children:s.jsx(F,{children:s.jsx(A,{placeholder:"Select one"})})}),s.jsxs(M,{children:[s.jsx(H,{value:"TODAY",children:"Today"}),s.jsx(H,{value:"YESTERDAY",children:"Yesterday"}),s.jsx(H,{value:"THIS_WEEK",children:"This week"}),s.jsx(H,{value:"THIS_MONTH",children:"This month"}),s.jsx(H,{value:"CUSTOM",children:"Custom"})]})]})]})}),o&&s.jsxs(s.Fragment,{children:[s.jsx(q,{control:u.control,name:"fromDate",render:({field:e})=>s.jsxs($,{children:[s.jsx(J,{children:"From Date"}),s.jsx(Z,{children:s.jsx(se,{type:"datetime-local",...e})})]})}),s.jsx(q,{control:u.control,name:"toDate",render:({field:e})=>s.jsxs($,{children:[s.jsx(J,{children:"To Date"}),s.jsx(Z,{children:s.jsx(se,{type:"datetime-local",...e})})]})})]}),s.jsx(q,{control:u.control,name:"senderId",render:({field:e})=>{var a;return s.jsxs($,{children:[s.jsx(J,{children:"Sender ID"}),s.jsxs(V,{onValueChange:s=>e.onChange(Number(s)),defaultValue:null==(a=e.value)?void 0:a.toString(),children:[s.jsx(Z,{children:s.jsx(F,{children:s.jsx(A,{placeholder:"Select sender ID"})})}),s.jsx(M,{children:g?s.jsx(H,{value:"loading",children:"Loading..."}):null==h?void 0:h.map((e=>s.jsx(H,{value:e.value.toString(),children:e.label},e.value)))})]}),s.jsx(ee,{})]})}}),s.jsx(q,{control:u.control,name:"msisdn",render:({field:e})=>s.jsxs($,{children:[s.jsx(J,{children:"Phone Number"}),s.jsx(Z,{children:s.jsx(se,{...e,placeholder:"2557XXXXXXX"})})]})}),s.jsx(q,{control:u.control,name:"status",render:({field:e})=>s.jsxs($,{children:[s.jsx(J,{children:"Status"}),s.jsxs(V,{onValueChange:e.onChange,defaultValue:e.value,children:[s.jsx(Z,{children:s.jsx(F,{children:s.jsx(A,{placeholder:"Select one"})})}),s.jsxs(M,{children:[s.jsx(H,{value:"DELIVERED",children:"Delivered"}),s.jsx(H,{value:"PENDING",children:"Pending"}),s.jsx(H,{value:"SENT",children:"Sent"}),s.jsx(H,{value:"FAILED",children:"Failed"})]})]})]})}),s.jsxs("div",{className:"col-span-full flex justify-end mt-4",children:[s.jsx(a,{type:"submit",variant:"default",disabled:d,children:d?"Applying...":"Apply Filters"}),s.jsx(a,{type:"button",variant:"outline",className:"ml-2",onClick:()=>{if(u.reset(),e.getAllColumns().forEach((e=>{e.setFilterValue(void 0)})),l){l({filters:[],sorts:[],page:0,size:10})}},disabled:d,children:"Clear Filters"})]})]})})})]})}function ue({columns:e,data:a,pagination:n,onPaginationChange:l,totalElements:r,onFilterSubmit:i}){var S;const[D,b]=t.useState({}),[y,C]=t.useState({}),[I,k]=t.useState([]),[E,T]=t.useState([]),P=o({data:a,columns:e,state:{sorting:E,columnVisibility:y,rowSelection:D,columnFilters:I,pagination:n},manualPagination:!0,pageCount:Math.ceil(r/n.pageSize),onPaginationChange:e=>{const s="function"==typeof e?e(n):e;l(s)},enableRowSelection:!0,onRowSelectionChange:b,onSortingChange:T,onColumnFiltersChange:k,onColumnVisibilityChange:C,getCoreRowModel:N(),getFilteredRowModel:w(),getPaginationRowModel:v(),getSortedRowModel:f(),getFacetedRowModel:p(),getFacetedUniqueValues:j()});return s.jsxs("div",{className:"space-y-4",children:[s.jsx(me,{table:P,onFilterSubmit:i}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(c,{children:[s.jsx(d,{children:P.getHeaderGroups().map((e=>s.jsx(m,{children:e.headers.map((e=>s.jsx(u,{colSpan:e.colSpan,children:e.isPlaceholder?null:x(e.column.columnDef.header,e.getContext())},e.id)))},e.id)))}),s.jsx(h,{children:(null==(S=P.getRowModel().rows)?void 0:S.length)?P.getRowModel().rows.map((e=>s.jsx(m,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map((e=>s.jsx(g,{children:x(e.column.columnDef.cell,e.getContext())},e.id)))},e.id))):s.jsx(m,{children:s.jsx(g,{colSpan:e.length,className:"h-24 text-center",children:"No results."})})})]})}),s.jsx(ie,{table:P})]})}function xe({column:e,title:t,className:n}){return e.getCanSort()?s.jsx("div",{className:l("flex items-center space-x-2",n),children:s.jsxs(Y,{children:[s.jsx(G,{asChild:!0,children:s.jsxs(a,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[s.jsx("span",{children:t}),"desc"===e.getIsSorted()?s.jsx(k,{className:"ml-2 h-4 w-4"}):"asc"===e.getIsSorted()?s.jsx(E,{className:"ml-2 h-4 w-4"}):s.jsx(T,{className:"ml-2 h-4 w-4"})]})}),s.jsxs(z,{align:"start",children:[s.jsxs(U,{onClick:()=>e.toggleSorting(!1),children:[s.jsx(E,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),s.jsxs(U,{onClick:()=>e.toggleSorting(!0),children:[s.jsx(k,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),s.jsx(B,{}),s.jsxs(U,{onClick:()=>e.toggleVisibility(!1),children:[s.jsx(P,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):s.jsx("div",{className:l(n),children:t})}const he=ge;function ge(e,s){const a=je();return(ge=function(e,s){return a[e-=350]})(e,s)}function je(){const e=["1434795KOQofd","any","214296YRcTNU","849294LNwTkk","9546219qSZPmf","(((.+)+)+)+$","constructor","1385462zdFWWY","1972740vyGBEl","22FedOJA","search","toString","object","4FvYdmd","203720vmQRBW","147Deqjnf","KRNQC","optional","4PIYBJT"];return(je=function(){return e})()}!function(){const e=ge,s=je();for(;;)try{if(934031===parseInt(e(367))/1+parseInt(e(354))/2*(parseInt(e(363))/3)+parseInt(e(359))/4*(-parseInt(e(360))/5)+-parseInt(e(362))/6*(-parseInt(e(356))/7)+-parseInt(e(355))/8+-parseInt(e(364))/9+-parseInt(e(368))/10*(parseInt(e(350))/11))break;s.push(s.shift())}catch(a){s.push(s.shift())}}();const pe=function(){let e=!0;return function(s,a){const t=e?function(){if(a){const e=a.apply(s,arguments);return a=null,e}}:function(){};return e=!1,t}}()(void 0,(function(){const e=ge,s={KRNQC:e(365)};return pe[e(352)]()[e(351)](s[e(357)])[e(352)]()[e(366)](pe)[e(351)](s.KRNQC)}));pe();const fe=_[he(353)]({id:_.number(),campaign:_[he(361)]()[he(358)](),senderId:_[he(361)]()[he(358)](),recipient:_[he(361)]()[he(358)](),message:_.any()[he(358)](),status:_[he(361)]().optional(),statusSmsc:_[he(361)]()[he(358)](),dlr:_.any()[he(358)](),network:_[he(361)]().optional(),smscUsername:_[he(361)]()[he(358)](),smscPassword:_[he(361)]()[he(358)](),sendingNetwork:_[he(361)]()[he(358)](),smsCount:_[he(361)]()[he(358)](),dateSent:_[he(361)]().optional(),customer:_[he(361)]()[he(358)](),plan:_.any()[he(358)](),messageId:_[he(361)]().optional(),smsType:_[he(361)]().optional(),template:_.any()[he(358)](),deliveryDate:_[he(361)]()[he(358)](),initiatedBy:_[he(361)]().optional(),createdAt:_[he(361)]().optional(),updatedAt:_[he(361)]().optional()});function ve({row:e}){const t=fe.parse(e.original),n=r();return s.jsxs(Y,{children:[s.jsx(G,{asChild:!0,children:s.jsxs(a,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[s.jsx(R,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Open menu"})]})}),s.jsxs(z,{align:"end",className:"w-[160px]",children:[s.jsx(U,{onClick:()=>{n("/message-detail",{state:{sms:t}})},children:"View"}),s.jsx(B,{}),s.jsx(U,{children:"Delete"})]})]})}const we=[{id:"select",header:({table:e})=>s.jsx(le,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>e.toggleAllPageRowsSelected(!!s),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:e})=>s.jsx(le,{checked:e.getIsSelected(),onCheckedChange:s=>e.toggleSelected(!!s),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:e})=>s.jsx(xe,{column:e,title:"#"}),cell:({row:e})=>s.jsx("div",{className:"w-[80px]",children:e.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"sender",header:({column:e})=>s.jsx(xe,{column:e,title:"Sender"}),cell:({row:e})=>s.jsx("span",{children:String(e.getValue("sender").senderId)})},{accessorKey:"recipient",header:({column:e})=>s.jsx(xe,{column:e,title:"Recipient"})},{accessorKey:"message",header:({column:e})=>s.jsx(xe,{column:e,title:"Message"}),cell:({row:e})=>s.jsxs("div",{className:"max-w-[150px] truncate",children:[String(e.getValue("message")).substring(0,50)," ..."]})},{accessorKey:"status",header:({column:e})=>s.jsx(xe,{column:e,title:"Status"}),cell:({row:e})=>s.jsx(ne,{variant:"FAILED"===e.getValue("status")?"destructive":"DELIVERED"===e.getValue("status")?"success":"secondary",children:e.getValue("status")})},{accessorKey:"network",header:({column:e})=>s.jsx(xe,{column:e,title:"Network"})},{accessorKey:"createdAt",header:({column:e})=>s.jsx(xe,{column:e,title:"Timestamp"}),cell:({row:e})=>i(e.original.createdAt).format("YYYY-MM-DD HH:mm:ss")},{id:"actions",cell:({row:e})=>s.jsx(ve,{row:e})}];export{ue as D,we as c};
