import{r as s,j as V,c as B}from"./index-st5SMf4n.js";const $=s.createContext(!1),j=s.forwardRef(({className:u,children:i,...A},E)=>{const{defaultValue:o,value:g,onChange:c,onComplete:p,onIncomplete:y,placeholder:I="â—‹",type:C="alphanumeric",name:N,form:D,otp:d=!1,mask:b=!1,disabled:v=!1,readOnly:P=!1,autoFocus:x=!1,ariaLabel:R="",...F}=A,K=L(i),m=M(i),{pins:t,pinValue:e,refMap:r,...n}=G({value:g,defaultValue:o,placeholder:I,type:C,length:m,readOnly:P});s.useEffect(()=>{c&&c(e)},[c,e]),s.useEffect(()=>{p&&e.length===m&&p(e),y&&e.length!==m&&y(e)},[m,p,y,e]),s.useEffect(()=>{if(!x)return;const w=r==null?void 0:r.get(0);w&&w.focus()},[x,r]);const a=s.useRef(0);let h=0;const _=K.map(w=>{if(w.type===k){const f=h;return h=h+1,s.cloneElement(w,{name:N,inputKey:`input-${f}`,value:m>f?t[f]:"",onChange:l=>n.handleChange(l,f),onFocus:l=>n.handleFocus(l,f),onBlur:()=>n.handleBlur(f),onKeyDown:l=>n.handleKeyDown(l,f),onPaste:l=>n.handlePaste(l),placeholder:I,type:C,mask:b,autoComplete:d?"one-time-code":"off",disabled:v,readOnly:P,"aria-label":R||`Pin input ${h} of ${m}`,ref:l=>{l?r==null||r.set(f,l):r==null||r.delete(f)}})}return a.current=a.current+1,w});return V.jsx($.Provider,{value:!0,children:V.jsxs("div",{ref:E,"aria-label":"Pin Input",className:u,...F,children:[_,V.jsx("input",{type:"hidden",name:N,form:D,value:e})]})})});j.displayName="PinInput";const T=({className:u,component:i,...A},E)=>{const{mask:o,type:g,inputKey:c,...p}=A;if(!s.useContext($))throw new Error(`PinInputField must be used within ${j.displayName}.`);const I=i||"input";return V.jsx(I,{ref:E,type:o?"password":g==="numeric"?"tel":"text",inputMode:g==="numeric"?"numeric":"text",className:B("size-10 text-center",u),...p},c)},k=s.forwardRef(T),G=({value:u,defaultValue:i,placeholder:A,type:E,length:o,readOnly:g})=>{const c=s.useMemo(()=>Array.from({length:o},(t,e)=>i?i.charAt(e):u?u.charAt(e):""),[i,o,u]),[p,y]=s.useState(c),I=p.join("").trim();s.useEffect(()=>{y(c)},[c]);const C=s.useRef(null);function N(){return C.current||(C.current=new Map),C.current}function D(t){const e=N();return e==null?void 0:e.get(t)}function d(t){const e=D(t);e&&(e.focus(),e.placeholder="")}function b(t,e){t.target.select(),d(e)}function v(t){const e=D(t);e&&(e.placeholder=A)}function P(t,e){const r=D(e);r&&(r.value=t),y(n=>n.map((a,h)=>h===e?t:a))}function x(t){return(E==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(t)}const R=s.useRef(null);function F(t,e){const r=t.target.value,n=R.current,a=n&&n.length===o?n.charAt(o-1):r.slice(-1);x(a)&&(P(a,e),R.current=null,r.length>0&&d(e+1))}function K(t){t.preventDefault();const e=t.clipboardData.getData("text/plain").replace(/[\n\r\s]+/g,""),r=e.split("").slice(0,o);if(r.every(a=>x(a))){for(let a=0;a<o;a++)a<r.length&&P(r[a],a);R.current=e,d(r.length<o?r.length:o-1)}}function m(t,e){const{ctrlKey:r,key:n,shiftKey:a,metaKey:h}=t;E==="numeric"&&(!(n==="Backspace"||n==="Tab"||n==="Control"||n==="Delete"||r&&n==="v"||h&&n==="v"||!Number.isNaN(Number(n)))||g)&&t.preventDefault(),n==="ArrowLeft"||a&&n==="Tab"?(t.preventDefault(),d(e-1)):n==="ArrowRight"||n==="Tab"||n===" "?(t.preventDefault(),d(e+1)):n==="Delete"?t.preventDefault():n==="Backspace"&&(t.preventDefault(),P("",e),t.target.value===""&&d(e-1))}return{pins:p,pinValue:I,refMap:N(),handleFocus:b,handleBlur:v,handleChange:F,handlePaste:K,handleKeyDown:m}},L=u=>s.Children.toArray(u).filter(i=>{if(s.isValidElement(i))return s.isValidElement(i);throw new Error(`${j.displayName} contains invalid children.`)}),M=u=>s.Children.toArray(u).filter(i=>{if(s.isValidElement(i)&&i.type===k)return s.isValidElement(i)}).length;export{j as P,k as a};
