import{j as e,B as s,l as a,r as t,c as l,m as n,y as i}from"./index-DgsANLC3.js";import{D as r,f as o,b as c,c as d,d as m,g as u,a as x,e as p,L as g}from"./use-auth-store-DlB6JPqf.js";import{u as h,S as j,T as f,U as v}from"./user-nav-BjY9odv6.js";import{u as N,T as w,a as C,b as S,c as b,f as y,d as I,e as k,g as P,h as E,i as A,j as V,k as R,l as D}from"./table-DgNG9M6V.js";import{D as T,C as F,d as M,e as z,M as B,F as G,f as H,A as K,g as O,h as $,E as J,i as L}from"./index-8bOQzAwE.js";import{S as q,a as U,b as Z,c as Q,d as X}from"./select-B9KeDb6u.js";import{I as W}from"./input-BaSBk-Gd.js";import{I as Y}from"./IconPlus-CVwxeCme.js";import{B as _}from"./badge-DkFHinrL.js";import{C as ee}from"./checkbox-CDTCacFG.js";import{z as se}from"./index-B0zZW6rS.js";import{C as ae}from"./cusstomer-approval-modal-3CVgqs6J.js";import{D as te,a as le,b as ne,c as ie,d as re}from"./dialog-Cxh4_yU0.js";import{u as oe}from"./useMutation-Bxa_RUaj.js";import{c as ce}from"./customer-hook-DtrhpQio.js";import"./index-D_xSc7Or.js";import"./index-ccUYw2Nl.js";import"./Combination-BCJfLLTG.js";import"./index-ByCmscx5.js";import"./index-BuCM2Ckj.js";import"./index-BQ1RgSiI.js";import"./instance-SAW19xTi.js";import"./index-DCG-2Pmh.js";import"./index-BEsgrMAU.js";import"./label-BTdkY-TR.js";import"./textarea-B6_lc-Cl.js";function de({table:a}){return e.jsxs("div",{className:"flex items-center justify-between overflow-auto px-2",children:[e.jsxs("div",{className:"hidden flex-1 text-sm text-muted-foreground sm:block",children:[a.getFilteredSelectedRowModel().rows.length," of"," ",a.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"flex items-center sm:space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"hidden text-sm font-medium sm:block",children:"Rows per page"}),e.jsxs(q,{value:`${a.getState().pagination.pageSize}`,onValueChange:e=>{a.setPageSize(Number(e))},children:[e.jsx(U,{className:"h-8 w-[70px]",children:e.jsx(Z,{placeholder:a.getState().pagination.pageSize})}),e.jsx(Q,{side:"top",children:[10,20,30,40,50].map((s=>e.jsx(X,{value:`${s}`,children:s},s)))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",a.getState().pagination.pageIndex+1," of"," ",a.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(s,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(0),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(T,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(F,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(M,{className:"h-4 w-4"})]}),e.jsxs(s,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>a.setPageIndex(a.getPageCount()-1),disabled:!a.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(z,{className:"h-4 w-4"})]})]})]})]})}function me({table:a}){return e.jsxs(r,{children:[e.jsx(o,{asChild:!0,children:e.jsxs(s,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(c,{align:"end",className:"w-[150px]",children:[e.jsx(d,{children:"Toggle columns"}),e.jsx(m,{}),a.getAllColumns().filter((e=>void 0!==e.accessorFn&&e.getCanHide())).map((s=>e.jsx(u,{className:"capitalize",checked:s.getIsVisible(),onCheckedChange:e=>s.toggleVisibility(!!e),children:s.id},s.id)))]})]})}function ue({table:t}){var l;const n=t.getState().columnFilters.length>0,i=a();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(W,{placeholder:"Filter customers...",value:(null==(l=t.getColumn("title"))?void 0:l.getFilterValue())??"",onChange:e=>{var s;return null==(s=t.getColumn("title"))?void 0:s.setFilterValue(e.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[e.jsxs(s,{variant:"default",onClick:()=>i("/customers/add"),className:"h-8 px-2 lg:px-3",children:["Add customer",e.jsx(Y,{className:"ml-2 h-4 w-4"})]}),e.jsxs(s,{variant:"default",className:"h-8 px-2 lg:px-3",children:["Export",e.jsx(G,{className:"ml-2 h-4 w-4"})]})]}),n&&e.jsxs(s,{variant:"ghost",onClick:()=>t.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(H,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(me,{table:t})]})}function xe({columns:s,data:a,pagination:l,onPaginationChange:n,totalElements:i}){var r;const[o,c]=t.useState({}),[d,m]=t.useState({}),[u,x]=t.useState([]),[p,g]=t.useState([]),h=N({data:a,columns:s,state:{sorting:p,columnVisibility:d,rowSelection:o,columnFilters:u,pagination:l},manualPagination:!0,pageCount:Math.ceil(i/l.pageSize),onPaginationChange:e=>{const s="function"==typeof e?e(l):e;n(s)},enableRowSelection:!0,onRowSelectionChange:c,onSortingChange:g,onColumnFiltersChange:x,onColumnVisibilityChange:m,getCoreRowModel:D(),getFilteredRowModel:R(),getPaginationRowModel:V(),getSortedRowModel:A(),getFacetedRowModel:E(),getFacetedUniqueValues:P()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{table:h}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(w,{children:[e.jsx(C,{children:h.getHeaderGroups().map((s=>e.jsx(S,{children:s.headers.map((s=>e.jsx(b,{colSpan:s.colSpan,children:s.isPlaceholder?null:y(s.column.columnDef.header,s.getContext())},s.id)))},s.id)))}),e.jsx(I,{children:(null==(r=h.getRowModel().rows)?void 0:r.length)?h.getRowModel().rows.map((s=>e.jsx(S,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map((s=>e.jsx(k,{children:y(s.column.columnDef.cell,s.getContext())},s.id)))},s.id))):e.jsx(S,{children:e.jsx(k,{colSpan:s.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(de,{table:h})]})}function pe({column:a,title:t,className:n}){return a.getCanSort()?e.jsx("div",{className:l("flex items-center space-x-2",n),children:e.jsxs(r,{children:[e.jsx(x,{asChild:!0,children:e.jsxs(s,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[e.jsx("span",{children:t}),"desc"===a.getIsSorted()?e.jsx(K,{className:"ml-2 h-4 w-4"}):"asc"===a.getIsSorted()?e.jsx(O,{className:"ml-2 h-4 w-4"}):e.jsx($,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(c,{align:"start",children:[e.jsxs(p,{onClick:()=>a.toggleSorting(!1),children:[e.jsx(O,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),e.jsxs(p,{onClick:()=>a.toggleSorting(!0),children:[e.jsx(K,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),e.jsx(m,{}),e.jsxs(p,{onClick:()=>a.toggleVisibility(!1),children:[e.jsx(J,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):e.jsx("div",{className:l(n),children:t})}const ge=he;function he(e,s){const a=fe();return(he=function(e,s){return a[e-=154]})(e,s)}!function(){const e=he,s=fe();for(;;)try{if(895161===-parseInt(e(173))/1*(-parseInt(e(158))/2)+parseInt(e(160))/3*(-parseInt(e(174))/4)+-parseInt(e(171))/5*(parseInt(e(163))/6)+parseInt(e(162))/7*(parseInt(e(156))/8)+parseInt(e(175))/9*(-parseInt(e(168))/10)+parseInt(e(157))/11*(parseInt(e(164))/12)+parseInt(e(165))/13)break;s.push(s.shift())}catch(a){s.push(s.shift())}}();const je=function(){let e=!0;return function(s,a){const t=e?function(){if(a){const e=a.apply(s,arguments);return a=null,e}}:function(){};return e=!1,t}}()(void 0,(function(){const e=he;return je[e(172)]()[e(166)]({jsBaT:"(((.+)+)+)+$"}[e(159)])[e(172)]().constructor(je)[e(166)](e(169))}));function fe(){const e=["629980KbhAXd","jsBaT","753bFArAs","number","10106747zZpabB","6GOyuwS","946596gBBsWN","11169613LvXklS","search","any","10ZfJbjT","(((.+)+)+)+$","email","23615mGiTME","toString","1rRrufx","24264ullmEm","6729687rbQlng","string","boolean","8sZzMyR","77gUlvHt"];return(fe=function(){return e})()}je();const ve=se.object({id:se[ge(161)](),email:se[ge(154)]()[ge(170)](),firstName:se[ge(154)](),lastName:se[ge(154)](),timezone:se.string(),status:se[ge(155)](),language:se.string(),companyName:se[ge(154)](),website:se[ge(167)](),customerType:se[ge(167)](),approvalStatus:se[ge(154)]()}),Ne=({mode:a,onClose:t,customerId:l})=>{const r=n(),o=oe({mutationFn:async()=>await ce.approveCustomer({id:l,remarks:"",approved:!1}),onSuccess:()=>{i.success("Customer approval revoked successfully"),r.invalidateQueries({queryKey:["customers"]}),t()},onError:e=>{var s,a;const t=(null==(a=null==(s=null==e?void 0:e.response)?void 0:s.data)?void 0:a.message)||"Failed to revoke approval";i.error(t)}});return e.jsx(te,{open:!0,onOpenChange:t,children:e.jsxs(le,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Customer Appproval"}),e.jsxs(re,{children:["Are you sure you want to confirm  ",e.jsx("strong",{children:"approve"===a?"Appproval":"Disapprove"}),"? This customer."]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(s,{variant:"secondary",onClick:t,children:"Cancel"}),e.jsx(s,{variant:"destructive",loading:o.isPending,onClick:()=>{if(a="approve")return t(),!0;o.mutate()},disabled:o.isPending,children:"Confirm"})]})]})})};function we({row:l}){const n=ve.parse(l.original),[i,o]=t.useState(!1),[d,m]=t.useState(!1),[u,g]=t.useState(!1),h=a();return e.jsxs(r,{children:[e.jsx(x,{asChild:!0,children:e.jsxs(s,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(c,{align:"end",className:"w-[160px]",children:[e.jsx(p,{onClick:()=>{h(`/customer/${n.id}`)},children:"View"}),"DISABLED"!==n.approvalStatus&&"REJECTED"!==n.approvalStatus&&e.jsx(p,{onClick:()=>g(!0),children:"Deactivate"}),"DISABLED"===n.approvalStatus&&e.jsx(p,{onClick:()=>o(!0),children:"Activate"}),"REJECTED"===n.approvalStatus&&e.jsx(p,{onClick:()=>o(!0),children:"Activate"}),"REJECTED"!==n.approvalStatus&&e.jsx(p,{onClick:()=>{h("/customers/add",{state:{record:n}})},children:"Edit"}),"PENDING"===n.approvalStatus&&e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>o(!0),children:"Approve"}),e.jsx(p,{onClick:()=>g(!0),children:"Reject"}),e.jsx(p,{children:"Delete"})]})]}),d&&e.jsx(Ne,{mode:"disapprove",customerId:null==n?void 0:n.id,onClose:()=>m(!1)}),i&&e.jsx(ae,{customerId:null==n?void 0:n.id,actionType:"PENDING"===n.approvalStatus?"APPROVE":"ACTIVATE",onClose:()=>{o(!1)}}),u&&e.jsx(ae,{customerId:null==n?void 0:n.id,actionType:"APPROVED"===n.approvalStatus?"DEACTIVATE":"REJECT",onClose:()=>{g(!1)}})]})}const Ce=[{id:"select",header:({table:s})=>e.jsx(ee,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(ee,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(pe,{column:s,title:"S/NO"}),cell:({row:s})=>e.jsx("div",{className:"w-[80px]",children:s.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:({column:s})=>e.jsx(pe,{column:s,title:"Email"}),cell:({row:s})=>e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("email")})},{accessorKey:"fullName",header:({column:s})=>e.jsx(pe,{column:s,title:"Name"}),cell:({row:s})=>{const a=s.original.firstName||"",t=s.original.lastName||"";return e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:`${a} ${t}`.trim()||"N/A"})}},{accessorKey:"companyName",header:({column:s})=>e.jsx(pe,{column:s,title:"Company"}),cell:({row:s})=>e.jsx("span",{className:"max-w-32 truncate font-medium sm:max-w-72 md:max-w-[31rem]",children:s.getValue("companyName")||"N/A"})},{accessorKey:"approvalStatus",header:({column:s})=>e.jsx(pe,{column:s,title:"Approval"}),cell:({row:s})=>e.jsx(_,{variant:"PENDING"===s.getValue("approvalStatus")||null===s.getValue("approvalStatus")?"secondary":"APPROVED"===s.getValue("approvalStatus")?"success":"destructive",children:s.getValue("approvalStatus")})},{accessorKey:"status",header:({column:s})=>e.jsx(pe,{column:s,title:"Status"}),cell:({row:s})=>e.jsx(_,{variant:!0===s.getValue("status")?"success":!1===s.getValue("status")?"secondary":"destructive",children:!0===s.getValue("status")?"Active":(s.getValue("status"),"Inactive")})},{id:"actions",cell:({row:s})=>e.jsx(we,{row:s})}];function Se(){const[s,a]=t.useState({pageIndex:0,pageSize:10}),{data:l,isLoading:n}=h({queryKey:["customers",s.pageIndex,s.pageSize],queryFn:async()=>await ce.getCustomers({page:s.pageIndex,size:s.pageSize})||[],retry:2,staleTime:3e5});return e.jsxs(g,{children:[e.jsxs(g.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(j,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(f,{}),e.jsx(v,{})]})]}),e.jsxs(g.Body,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Customers"}),e.jsx("p",{className:"text-muted-foreground",children:"Here's a list of your customers"})]})}),n?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-gray-900 dark:border-white"})}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(xe,{data:l||[],columns:Ce,pagination:s,onPaginationChange:a,totalElements:(null==l?void 0:l.totalElements)||0})})]})]})}export{Se as default};
