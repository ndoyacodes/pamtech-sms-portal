import{j as e,B as y}from"./index-d9TgJTTy.js";import{u as v}from"./index.esm-B6ab4Cq_.js";import{z as o}from"./index-C3hmKdn7.js";import{t as P}from"./zod-CLsu2KRF.js";import{F as N,a as u,b as p,c as x,d as h,e as j}from"./form-DxQsSBla.js";import{I as F}from"./input-DpwfBUf3.js";import{L as n}from"./use-auth-store-CiawQdvf.js";import{u as I,S as T,T as w,U as L}from"./user-nav-1-09pvFT.js";import{S as C}from"./react-select.esm-BLyL2-KV.js";import{p as $}from"./plan.service-DETDn82p.js";import{u as B}from"./plan-hooks-BiPaak9a.js";import"./label-BkzUlrRU.js";import"./index-Chc_HW3c.js";import"./index-CD610jSn.js";import"./index-EIcx_2LO.js";import"./Combination-D2mTRfsA.js";import"./index-LU4gLCaG.js";import"./index-DT5heVsp.js";import"./index-BIPiAFp5.js";import"./instance-BGpPafi2.js";import"./extends-CF3RwP-h.js";import"./index-DTsOzCj_.js";import"./useMutation-scFYzLXQ.js";const M=o.object({planId:o.number().min(1,"Please select a plan"),amount:o.string().min(1,"Please enter amount")}),te=()=>{const{createSubscriptionPlan:m}=B(),r=v({resolver:P(M),defaultValues:{amount:"",planId:0}}),f=r.watch("planId"),i=r.watch("amount"),{data:a,isLoading:S}=I({queryKey:["plans"],queryFn:async()=>await $.getPlans({page:0,size:10})||[],retry:2,staleTime:5*60*1e3}),l=a==null?void 0:a.find(s=>s.id===f),b=l&&i?Math.floor(Number(i)/l.pricePerSms):0,g=s=>{console.log("Submitted Data:",s),m.mutate({data:{planId:s.planId,amount:s.amount}})};return e.jsxs(n,{children:[e.jsxs(n.Header,{sticky:!0,className:"mt-4 lg:mt-0 md:mt-0 sm:mt-4",children:[e.jsx(T,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(w,{}),e.jsx(L,{})]})]}),e.jsx(n.Body,{children:e.jsxs("div",{className:"mx-auto max-w-6xl rounded-md p-8 shadow-md",children:[e.jsx("h2",{className:"mb-6 text-2xl font-semibold",children:"Top Up"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Add balance to your account to send messages"}),e.jsx(N,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(g),className:"space-y-6",children:[e.jsx(u,{control:r.control,name:"planId",render:({field:s})=>{var c,d;return e.jsxs(p,{children:[e.jsx(x,{children:"Plan"}),e.jsx(h,{children:e.jsx(C,{className:"my-react-select-container",classNamePrefix:"my-react-select",isLoading:S,placeholder:"Select a plan",options:a==null?void 0:a.map(t=>({value:t.id,label:`${t.name} - ${t.pricePerSms} TZS`})),onChange:t=>s.onChange(t==null?void 0:t.value),value:a!=null&&a.find(t=>t.id===s.value)?{value:s.value,label:`${(c=a==null?void 0:a.find(t=>t.id===s.value))==null?void 0:c.name} - ${(d=a.find(t=>t.id===s.value))==null?void 0:d.pricePerSms} TZS`}:null})}),e.jsx(j,{})]})}}),e.jsx(u,{control:r.control,name:"amount",render:({field:s})=>e.jsxs(p,{children:[e.jsx(x,{children:"Amount (TZS)"}),e.jsx(h,{children:e.jsx(F,{placeholder:"Enter amount",...s,type:"number"})}),e.jsx(j,{})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Number of SMS: ",e.jsx("strong",{children:b})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"submit",loading:m.isPending,disabled:m.isPending,children:"Checkout"})})]})})]})})]})};export{te as CampaignBuilder,te as default};
